{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Dask Tutorial\n",
    "\n",
    "\n",
    "<div class=\"alert-info\">\n",
    "\n",
    "### Overview\n",
    "    \n",
    "* **teaching:** 20 minutes\n",
    "* **exercises:** 0\n",
    "* **questions:**\n",
    "    * How does Dask parallelize computations in Python?\n",
    "</div>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Table of contents\n",
    "1. [**Dask primer**](#Dask-primer)\n",
    "1. [**Dask clusters**](#Dask-Clusters)\n",
    "1. [**Dask dataframe**](#Dask-Dataframe)\n",
    "1. [**Dask arrays**](#Dask-Arrays)\n",
    "1. [**Dask delayed**](#Dask-Delayed)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Dask Primer\n",
    "\n",
    "<img src=\"http://dask.readthedocs.io/en/latest/_images/dask_horizontal.svg\" \n",
    "     width=\"30%\" \n",
    "     align=right\n",
    "     alt=\"Dask logo\">\n",
    "\n",
    "\n",
    "Dask is a flexible parallel computing library for analytic computing. Dask provides dynamic parallel task scheduling and high-level big-data collections like `dask.array` and `dask.dataframe`. More on dask here: https://docs.dask.org/en/latest/\n",
    "\n",
    "_Note: Pieces of this notebook comes from the following sources:_\n",
    "\n",
    "- https://github.com/rabernat/research_computing\n",
    "- https://github.com/dask/dask-examples"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Dask Clusters\n",
    "\n",
    "Dask needs a collection of computing resources in order to perform parallel computations. Dask Clusters have different names corresponding to different computing environments (for example, [LocalCluster](https://distributed.dask.org/en/latest/local-cluster.html) for your Laptop, [PBSCluster](http://jobqueue.dask.org/) for your HPC, or [Kubernetes Cluster](http://kubernetes.dask.org/) for machines on the Cloud). Each cluster has a certain number of computing resources called 'Workers', that each get allocated CPU and RAM. The dask scheduling system maps jobs to each worker on a cluster for you, so the syntax is mostly the same once you initialize a cluster!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table style=\"border: 2px solid white;\">\n",
       "<tr>\n",
       "<td style=\"vertical-align: top; border: 0px solid white\">\n",
       "<h3 style=\"text-align: left;\">Client</h3>\n",
       "<ul style=\"text-align: left; list-style: none; margin: 0; padding: 0;\">\n",
       "  <li><b>Scheduler: </b>tcp://127.0.0.1:45935</li>\n",
       "  <li><b>Dashboard: </b><a href='/user/pangeo-data-pan-utorial-gallery-ootv4hp3/proxy/8787/status' target='_blank'>/user/pangeo-data-pan-utorial-gallery-ootv4hp3/proxy/8787/status</a></li>\n",
       "</ul>\n",
       "</td>\n",
       "<td style=\"vertical-align: top; border: 0px solid white\">\n",
       "<h3 style=\"text-align: left;\">Cluster</h3>\n",
       "<ul style=\"text-align: left; list-style:none; margin: 0; padding: 0;\">\n",
       "  <li><b>Workers: </b>2</li>\n",
       "  <li><b>Cores: </b>2</li>\n",
       "  <li><b>Memory: </b>8.59 GB</li>\n",
       "</ul>\n",
       "</td>\n",
       "</tr>\n",
       "</table>"
      ],
      "text/plain": [
       "<Client: 'tcp://127.0.0.1:45935' processes=2 threads=2, memory=8.59 GB>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Let's start simple with a LocalCluster that makes use of all the cores and RAM we have on a single machine\n",
    "from dask.distributed import Client, LocalCluster\n",
    "cluster = LocalCluster()\n",
    "# explicitly connect to the cluster we just created\n",
    "client = Client(cluster)\n",
    "client"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Dask Dataframe\n",
    "\n",
    "If you are working with a very large Pandas dataframe, you can consider parallizing computations by turning it into a Dask Dataframe. Dask Dataframes split a dataframe into partitions along an index. They support a large subset of the Pandas API. You can find additional details and examples here https://examples.dask.org/dataframe.html\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Although this is small csv file, we'll reuse our same example from before!\n",
    "# Load csv results from server into a Pandas DataFrame\n",
    "import dask.dataframe as dd\n",
    "server = 'https://webservices.volcano.si.edu/geoserver/GVP-VOTW/ows?'\n",
    "query = 'service=WFS&version=2.0.0&request=GetFeature&typeName=GVP-VOTW:Smithsonian_VOTW_Holocene_Volcanoes&outputFormat=csv'\n",
    "\n",
    "# blocksize=None means use a single partion\n",
    "df = dd.read_csv(server+query, blocksize=None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><strong>Dask DataFrame Structure:</strong></div>\n",
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>FID</th>\n",
       "      <th>Volcano_Number</th>\n",
       "      <th>Volcano_Name</th>\n",
       "      <th>Primary_Volcano_Type</th>\n",
       "      <th>Last_Eruption_Year</th>\n",
       "      <th>Country</th>\n",
       "      <th>Geological_Summary</th>\n",
       "      <th>Region</th>\n",
       "      <th>Subregion</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "      <th>Elevation</th>\n",
       "      <th>Tectonic_Setting</th>\n",
       "      <th>Geologic_Epoch</th>\n",
       "      <th>Evidence_Category</th>\n",
       "      <th>Primary_Photo_Link</th>\n",
       "      <th>Primary_Photo_Caption</th>\n",
       "      <th>Primary_Photo_Credit</th>\n",
       "      <th>Major_Rock_Type</th>\n",
       "      <th>GeoLocation</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>npartitions=1</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <td>object</td>\n",
       "      <td>int64</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>float64</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>float64</td>\n",
       "      <td>float64</td>\n",
       "      <td>int64</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>\n",
       "<div>Dask Name: from-delayed, 3 tasks</div>"
      ],
      "text/plain": [
       "Dask DataFrame Structure:\n",
       "                  FID Volcano_Number Volcano_Name Primary_Volcano_Type Last_Eruption_Year Country Geological_Summary  Region Subregion Latitude Longitude Elevation Tectonic_Setting Geologic_Epoch Evidence_Category Primary_Photo_Link Primary_Photo_Caption Primary_Photo_Credit Major_Rock_Type GeoLocation\n",
       "npartitions=1                                                                                                                                                                                                                                                                                                  \n",
       "               object          int64       object               object            float64  object             object  object    object  float64   float64     int64           object         object            object             object                object               object          object      object\n",
       "                  ...            ...          ...                  ...                ...     ...                ...     ...       ...      ...       ...       ...              ...            ...               ...                ...                   ...                  ...             ...         ...\n",
       "Dask Name: from-delayed, 3 tasks"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# We only see the metadata, the actual data are only computed when requested.\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><strong>Dask DataFrame Structure:</strong></div>\n",
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>FID</th>\n",
       "      <th>Volcano_Number</th>\n",
       "      <th>Volcano_Name</th>\n",
       "      <th>Primary_Volcano_Type</th>\n",
       "      <th>Last_Eruption_Year</th>\n",
       "      <th>Country</th>\n",
       "      <th>Geological_Summary</th>\n",
       "      <th>Region</th>\n",
       "      <th>Subregion</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "      <th>Elevation</th>\n",
       "      <th>Tectonic_Setting</th>\n",
       "      <th>Geologic_Epoch</th>\n",
       "      <th>Evidence_Category</th>\n",
       "      <th>Primary_Photo_Link</th>\n",
       "      <th>Primary_Photo_Caption</th>\n",
       "      <th>Primary_Photo_Credit</th>\n",
       "      <th>Major_Rock_Type</th>\n",
       "      <th>GeoLocation</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>npartitions=4</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <td>object</td>\n",
       "      <td>int64</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>float64</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>float64</td>\n",
       "      <td>float64</td>\n",
       "      <td>int64</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "      <td>object</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>\n",
       "<div>Dask Name: repartition, 8 tasks</div>"
      ],
      "text/plain": [
       "Dask DataFrame Structure:\n",
       "                  FID Volcano_Number Volcano_Name Primary_Volcano_Type Last_Eruption_Year Country Geological_Summary  Region Subregion Latitude Longitude Elevation Tectonic_Setting Geologic_Epoch Evidence_Category Primary_Photo_Link Primary_Photo_Caption Primary_Photo_Credit Major_Rock_Type GeoLocation\n",
       "npartitions=4                                                                                                                                                                                                                                                                                                  \n",
       "               object          int64       object               object            float64  object             object  object    object  float64   float64     int64           object         object            object             object                object               object          object      object\n",
       "                  ...            ...          ...                  ...                ...     ...                ...     ...       ...      ...       ...       ...              ...            ...               ...                ...                   ...                  ...             ...         ...\n",
       "                  ...            ...          ...                  ...                ...     ...                ...     ...       ...      ...       ...       ...              ...            ...               ...                ...                   ...                  ...             ...         ...\n",
       "                  ...            ...          ...                  ...                ...     ...                ...     ...       ...      ...       ...       ...              ...            ...               ...                ...                   ...                  ...             ...         ...\n",
       "                  ...            ...          ...                  ...                ...     ...                ...     ...       ...      ...       ...       ...              ...            ...               ...                ...                   ...                  ...             ...         ...\n",
       "Dask Name: repartition, 8 tasks"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# We can break up the table into 4 partions to map out to each core:\n",
    "df = df.repartition(npartitions=4)\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "dd.Scalar<series-..., dtype=float64>"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Let's say we want to know the minimum last eruption year for all volcanoes\n",
    "last_eruption_year_min = df.Last_Eruption_Year.min()\n",
    "last_eruption_year_min"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<svg height=\"1903pt\" viewBox=\"0.00 0.00 789.98 1903.21\" width=\"790pt\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g class=\"graph\" id=\"graph0\" transform=\"scale(1 1) rotate(0) translate(4 1899.21)\">\n",
       "<title>%3</title>\n",
       "<polygon fill=\"white\" points=\"-4,4 -4,-1899.21 785.98,-1899.21 785.98,4 -4,4\" stroke=\"transparent\"/>\n",
       "<!-- 2601543240941214889 -->\n",
       "<g class=\"node\" id=\"node1\">\n",
       "<title>2601543240941214889</title>\n",
       "<ellipse cx=\"90.99\" cy=\"-1465.63\" fill=\"none\" rx=\"90.98\" ry=\"90.98\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"90.99\" y=\"-1461.93\">series-min-chunk</text>\n",
       "</g>\n",
       "<!-- 3348194319578185718 -->\n",
       "<g class=\"node\" id=\"node2\">\n",
       "<title>3348194319578185718</title>\n",
       "<polygon fill=\"none\" points=\"208.99,-1628.62 136.99,-1628.62 136.99,-1592.62 208.99,-1592.62 208.99,-1628.62\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"172.99\" y=\"-1606.92\">(0, 0, 0)</text>\n",
       "</g>\n",
       "<!-- 2601543240941214889&#45;&gt;3348194319578185718 -->\n",
       "<g class=\"edge\" id=\"edge1\">\n",
       "<title>2601543240941214889-&gt;3348194319578185718</title>\n",
       "<path d=\"M135.83,-1544.82C143.89,-1558.88 151.76,-1572.59 158.16,-1583.75\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"155.15,-1585.54 163.16,-1592.48 161.22,-1582.06 155.15,-1585.54\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 5494213196893201772 -->\n",
       "<g class=\"node\" id=\"node13\">\n",
       "<title>5494213196893201772</title>\n",
       "<ellipse cx=\"362.99\" cy=\"-1743.91\" fill=\"none\" rx=\"79.09\" ry=\"79.09\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"362.99\" y=\"-1740.21\">series-min-agg</text>\n",
       "</g>\n",
       "<!-- 3348194319578185718&#45;&gt;5494213196893201772 -->\n",
       "<g class=\"edge\" id=\"edge13\">\n",
       "<title>3348194319578185718-&gt;5494213196893201772</title>\n",
       "<path d=\"M197.83,-1628.78C221.1,-1644.86 257.06,-1669.71 289.49,-1692.12\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"287.87,-1695.26 298.09,-1698.06 291.85,-1689.5 287.87,-1695.26\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;9094948606648219252 -->\n",
       "<g class=\"node\" id=\"node3\">\n",
       "<title>-9094948606648219252</title>\n",
       "<polygon fill=\"none\" points=\"124.99,-1338.64 70.99,-1338.64 70.99,-1302.64 124.99,-1302.64 124.99,-1338.64\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"97.99\" y=\"-1316.94\">0</text>\n",
       "</g>\n",
       "<!-- &#45;9094948606648219252&#45;&gt;2601543240941214889 -->\n",
       "<g class=\"edge\" id=\"edge2\">\n",
       "<title>-9094948606648219252-&gt;2601543240941214889</title>\n",
       "<path d=\"M97.15,-1338.88C96.8,-1345.94 96.37,-1354.71 95.9,-1364.31\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"92.39,-1364.42 95.4,-1374.58 99.39,-1364.76 92.39,-1364.42\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 3897568354810495724 -->\n",
       "<g class=\"node\" id=\"node4\">\n",
       "<title>3897568354810495724</title>\n",
       "<ellipse cx=\"290.99\" cy=\"-1465.63\" fill=\"none\" rx=\"90.98\" ry=\"90.98\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"290.99\" y=\"-1461.93\">series-min-chunk</text>\n",
       "</g>\n",
       "<!-- 3348192866087189243 -->\n",
       "<g class=\"node\" id=\"node5\">\n",
       "<title>3348192866087189243</title>\n",
       "<polygon fill=\"none\" points=\"353.99,-1628.62 281.99,-1628.62 281.99,-1592.62 353.99,-1592.62 353.99,-1628.62\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"317.99\" y=\"-1606.92\">(0, 1, 0)</text>\n",
       "</g>\n",
       "<!-- 3897568354810495724&#45;&gt;3348192866087189243 -->\n",
       "<g class=\"edge\" id=\"edge3\">\n",
       "<title>3897568354810495724-&gt;3348192866087189243</title>\n",
       "<path d=\"M307.71,-1555.15C309.57,-1565 311.34,-1574.4 312.88,-1582.53\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"309.45,-1583.23 314.74,-1592.41 316.33,-1581.94 309.45,-1583.23\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 3348192866087189243&#45;&gt;5494213196893201772 -->\n",
       "<g class=\"edge\" id=\"edge11\">\n",
       "<title>3348192866087189243-&gt;5494213196893201772</title>\n",
       "<path d=\"M323.87,-1628.78C326.7,-1637.04 330.32,-1647.6 334.22,-1658.96\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"330.99,-1660.33 337.54,-1668.66 337.61,-1658.06 330.99,-1660.33\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;9094948606649301777 -->\n",
       "<g class=\"node\" id=\"node6\">\n",
       "<title>-9094948606649301777</title>\n",
       "<polygon fill=\"none\" points=\"318.99,-1338.64 264.99,-1338.64 264.99,-1302.64 318.99,-1302.64 318.99,-1338.64\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"291.99\" y=\"-1316.94\">1</text>\n",
       "</g>\n",
       "<!-- &#45;9094948606649301777&#45;&gt;3897568354810495724 -->\n",
       "<g class=\"edge\" id=\"edge4\">\n",
       "<title>-9094948606649301777-&gt;3897568354810495724</title>\n",
       "<path d=\"M291.87,-1338.88C291.82,-1345.94 291.76,-1354.71 291.69,-1364.31\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"288.19,-1364.55 291.62,-1374.58 295.19,-1364.6 288.19,-1364.55\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 890605928876567627 -->\n",
       "<g class=\"node\" id=\"node7\">\n",
       "<title>890605928876567627</title>\n",
       "<ellipse cx=\"490.99\" cy=\"-1465.63\" fill=\"none\" rx=\"90.98\" ry=\"90.98\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"490.99\" y=\"-1461.93\">series-min-chunk</text>\n",
       "</g>\n",
       "<!-- 3348197226560178668 -->\n",
       "<g class=\"node\" id=\"node8\">\n",
       "<title>3348197226560178668</title>\n",
       "<polygon fill=\"none\" points=\"498.99,-1628.62 426.99,-1628.62 426.99,-1592.62 498.99,-1592.62 498.99,-1628.62\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"462.99\" y=\"-1606.92\">(0, 2, 0)</text>\n",
       "</g>\n",
       "<!-- 890605928876567627&#45;&gt;3348197226560178668 -->\n",
       "<g class=\"edge\" id=\"edge5\">\n",
       "<title>890605928876567627-&gt;3348197226560178668</title>\n",
       "<path d=\"M473.66,-1555.15C471.73,-1565 469.89,-1574.4 468.3,-1582.53\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"464.85,-1581.92 466.36,-1592.41 471.72,-1583.27 464.85,-1581.92\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 3348197226560178668&#45;&gt;5494213196893201772 -->\n",
       "<g class=\"edge\" id=\"edge12\">\n",
       "<title>3348197226560178668-&gt;5494213196893201772</title>\n",
       "<path d=\"M449.92,-1628.78C441.23,-1640.19 429.18,-1656.02 416.81,-1672.25\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"414,-1670.16 410.73,-1680.24 419.57,-1674.4 414,-1670.16\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;9094948606646054202 -->\n",
       "<g class=\"node\" id=\"node9\">\n",
       "<title>-9094948606646054202</title>\n",
       "<polygon fill=\"none\" points=\"516.99,-1338.64 462.99,-1338.64 462.99,-1302.64 516.99,-1302.64 516.99,-1338.64\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"489.99\" y=\"-1316.94\">2</text>\n",
       "</g>\n",
       "<!-- &#45;9094948606646054202&#45;&gt;890605928876567627 -->\n",
       "<g class=\"edge\" id=\"edge6\">\n",
       "<title>-9094948606646054202-&gt;890605928876567627</title>\n",
       "<path d=\"M490.11,-1338.88C490.16,-1345.94 490.22,-1354.71 490.29,-1364.31\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"486.79,-1364.6 490.36,-1374.58 493.79,-1364.55 486.79,-1364.6\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 7907393229827245942 -->\n",
       "<g class=\"node\" id=\"node10\">\n",
       "<title>7907393229827245942</title>\n",
       "<ellipse cx=\"690.99\" cy=\"-1465.63\" fill=\"none\" rx=\"90.98\" ry=\"90.98\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"690.99\" y=\"-1461.93\">series-min-chunk</text>\n",
       "</g>\n",
       "<!-- 3348195773069182193 -->\n",
       "<g class=\"node\" id=\"node11\">\n",
       "<title>3348195773069182193</title>\n",
       "<polygon fill=\"none\" points=\"670.99,-1628.62 598.99,-1628.62 598.99,-1592.62 670.99,-1592.62 670.99,-1628.62\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"634.99\" y=\"-1606.92\">(0, 3, 0)</text>\n",
       "</g>\n",
       "<!-- 7907393229827245942&#45;&gt;3348195773069182193 -->\n",
       "<g class=\"edge\" id=\"edge7\">\n",
       "<title>7907393229827245942-&gt;3348195773069182193</title>\n",
       "<path d=\"M658.09,-1550.63C653.51,-1562.33 649.11,-1573.57 645.4,-1583.04\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"642.06,-1581.97 641.67,-1592.56 648.58,-1584.52 642.06,-1581.97\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 3348195773069182193&#45;&gt;5494213196893201772 -->\n",
       "<g class=\"edge\" id=\"edge10\">\n",
       "<title>3348195773069182193-&gt;5494213196893201772</title>\n",
       "<path d=\"M599.71,-1628.65C560.32,-1647.66 495.28,-1679.06 443.33,-1704.13\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"441.61,-1701.08 434.12,-1708.58 444.65,-1707.38 441.61,-1701.08\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;9094948606647136727 -->\n",
       "<g class=\"node\" id=\"node12\">\n",
       "<title>-9094948606647136727</title>\n",
       "<polygon fill=\"none\" points=\"713.99,-1338.64 659.99,-1338.64 659.99,-1302.64 713.99,-1302.64 713.99,-1338.64\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"686.99\" y=\"-1316.94\">3</text>\n",
       "</g>\n",
       "<!-- &#45;9094948606647136727&#45;&gt;7907393229827245942 -->\n",
       "<g class=\"edge\" id=\"edge8\">\n",
       "<title>-9094948606647136727-&gt;7907393229827245942</title>\n",
       "<path d=\"M687.47,-1338.88C687.67,-1345.94 687.92,-1354.71 688.19,-1364.31\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"684.69,-1364.68 688.47,-1374.58 691.69,-1364.48 684.69,-1364.68\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 3816200149301635195 -->\n",
       "<g class=\"node\" id=\"node14\">\n",
       "<title>3816200149301635195</title>\n",
       "<polygon fill=\"none\" points=\"389.99,-1895.21 335.99,-1895.21 335.99,-1859.21 389.99,-1859.21 389.99,-1895.21\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"362.99\" y=\"-1873.51\">0</text>\n",
       "</g>\n",
       "<!-- 5494213196893201772&#45;&gt;3816200149301635195 -->\n",
       "<g class=\"edge\" id=\"edge9\">\n",
       "<title>5494213196893201772-&gt;3816200149301635195</title>\n",
       "<path d=\"M362.99,-1823.56C362.99,-1832.62 362.99,-1841.33 362.99,-1848.97\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"359.49,-1848.99 362.99,-1858.99 366.49,-1848.99 359.49,-1848.99\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;4115089967492428757 -->\n",
       "<g class=\"node\" id=\"node15\">\n",
       "<title>-4115089967492428757</title>\n",
       "<ellipse cx=\"112.99\" cy=\"-1219.84\" fill=\"none\" rx=\"46.59\" ry=\"46.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"112.99\" y=\"-1216.14\">getitem</text>\n",
       "</g>\n",
       "<!-- &#45;4115089967492428757&#45;&gt;&#45;9094948606648219252 -->\n",
       "<g class=\"edge\" id=\"edge14\">\n",
       "<title>-4115089967492428757-&gt;-9094948606648219252</title>\n",
       "<path d=\"M106.11,-1266.19C104.76,-1275.08 103.38,-1284.14 102.15,-1292.22\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"98.68,-1291.76 100.64,-1302.18 105.6,-1292.81 98.68,-1291.76\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;8969330059910692832 -->\n",
       "<g class=\"node\" id=\"node16\">\n",
       "<title>-8969330059910692832</title>\n",
       "<polygon fill=\"none\" points=\"169.99,-1137.04 115.99,-1137.04 115.99,-1101.04 169.99,-1101.04 169.99,-1137.04\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"142.99\" y=\"-1115.34\">0</text>\n",
       "</g>\n",
       "<!-- &#45;8969330059910692832&#45;&gt;&#45;4115089967492428757 -->\n",
       "<g class=\"edge\" id=\"edge15\">\n",
       "<title>-8969330059910692832-&gt;-4115089967492428757</title>\n",
       "<path d=\"M137.77,-1137.25C135.37,-1145.13 132.4,-1154.94 129.34,-1165\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"125.96,-1164.08 126.41,-1174.66 132.66,-1166.11 125.96,-1164.08\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 4551209659911290784 -->\n",
       "<g class=\"node\" id=\"node17\">\n",
       "<title>4551209659911290784</title>\n",
       "<ellipse cx=\"321.99\" cy=\"-1219.84\" fill=\"none\" rx=\"46.59\" ry=\"46.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"321.99\" y=\"-1216.14\">getitem</text>\n",
       "</g>\n",
       "<!-- 4551209659911290784&#45;&gt;&#45;9094948606649301777 -->\n",
       "<g class=\"edge\" id=\"edge16\">\n",
       "<title>4551209659911290784-&gt;-9094948606649301777</title>\n",
       "<path d=\"M308.66,-1264.75C305.73,-1274.38 302.72,-1284.29 300.08,-1293\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"296.73,-1291.99 297.17,-1302.57 303.43,-1294.02 296.73,-1291.99\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;8969330059911775357 -->\n",
       "<g class=\"node\" id=\"node18\">\n",
       "<title>-8969330059911775357</title>\n",
       "<polygon fill=\"none\" points=\"350.99,-1137.04 296.99,-1137.04 296.99,-1101.04 350.99,-1101.04 350.99,-1137.04\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"323.99\" y=\"-1115.34\">1</text>\n",
       "</g>\n",
       "<!-- &#45;8969330059911775357&#45;&gt;4551209659911290784 -->\n",
       "<g class=\"edge\" id=\"edge17\">\n",
       "<title>-8969330059911775357-&gt;4551209659911290784</title>\n",
       "<path d=\"M323.64,-1137.25C323.5,-1144.56 323.31,-1153.53 323.13,-1162.82\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"319.62,-1162.9 322.92,-1172.97 326.62,-1163.04 319.62,-1162.9\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;6284506148061504007 -->\n",
       "<g class=\"node\" id=\"node19\">\n",
       "<title>-6284506148061504007</title>\n",
       "<ellipse cx=\"489.99\" cy=\"-1219.84\" fill=\"none\" rx=\"46.59\" ry=\"46.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"489.99\" y=\"-1216.14\">getitem</text>\n",
       "</g>\n",
       "<!-- &#45;6284506148061504007&#45;&gt;&#45;9094948606646054202 -->\n",
       "<g class=\"edge\" id=\"edge18\">\n",
       "<title>-6284506148061504007-&gt;-9094948606646054202</title>\n",
       "<path d=\"M489.99,-1266.77C489.99,-1275.5 489.99,-1284.37 489.99,-1292.3\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"486.49,-1292.41 489.99,-1302.41 493.49,-1292.41 486.49,-1292.41\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;8969330059908527782 -->\n",
       "<g class=\"node\" id=\"node20\">\n",
       "<title>-8969330059908527782</title>\n",
       "<polygon fill=\"none\" points=\"509.99,-1137.04 455.99,-1137.04 455.99,-1101.04 509.99,-1101.04 509.99,-1137.04\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"482.99\" y=\"-1115.34\">2</text>\n",
       "</g>\n",
       "<!-- &#45;8969330059908527782&#45;&gt;&#45;6284506148061504007 -->\n",
       "<g class=\"edge\" id=\"edge19\">\n",
       "<title>-8969330059908527782-&gt;-6284506148061504007</title>\n",
       "<path d=\"M484.21,-1137.25C484.73,-1144.56 485.36,-1153.53 486.02,-1162.82\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"482.54,-1163.24 486.74,-1172.97 489.53,-1162.74 482.54,-1163.24\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;7606930873438132482 -->\n",
       "<g class=\"node\" id=\"node21\">\n",
       "<title>-7606930873438132482</title>\n",
       "<ellipse cx=\"679.99\" cy=\"-1219.84\" fill=\"none\" rx=\"46.59\" ry=\"46.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"679.99\" y=\"-1216.14\">getitem</text>\n",
       "</g>\n",
       "<!-- &#45;7606930873438132482&#45;&gt;&#45;9094948606647136727 -->\n",
       "<g class=\"edge\" id=\"edge20\">\n",
       "<title>-7606930873438132482-&gt;-9094948606647136727</title>\n",
       "<path d=\"M683.25,-1266.77C683.86,-1275.5 684.49,-1284.37 685.05,-1292.3\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"681.57,-1292.68 685.77,-1302.41 688.56,-1292.18 681.57,-1292.68\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;8969330059909610307 -->\n",
       "<g class=\"node\" id=\"node22\">\n",
       "<title>-8969330059909610307</title>\n",
       "<polygon fill=\"none\" points=\"669.99,-1137.04 615.99,-1137.04 615.99,-1101.04 669.99,-1101.04 669.99,-1137.04\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"642.99\" y=\"-1115.34\">3</text>\n",
       "</g>\n",
       "<!-- &#45;8969330059909610307&#45;&gt;&#45;7606930873438132482 -->\n",
       "<g class=\"edge\" id=\"edge21\">\n",
       "<title>-8969330059909610307-&gt;-7606930873438132482</title>\n",
       "<path d=\"M649.44,-1137.25C652.48,-1145.38 656.3,-1155.57 660.19,-1165.96\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"656.98,-1167.37 663.76,-1175.51 663.53,-1164.91 656.98,-1167.37\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 8767080603036132088 -->\n",
       "<g class=\"node\" id=\"node23\">\n",
       "<title>8767080603036132088</title>\n",
       "<ellipse cx=\"410.99\" cy=\"-803.66\" fill=\"none\" rx=\"31.4\" ry=\"31.4\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"410.99\" y=\"-799.96\">split</text>\n",
       "</g>\n",
       "<!-- &#45;4585936485244960297 -->\n",
       "<g class=\"node\" id=\"node24\">\n",
       "<title>-4585936485244960297</title>\n",
       "<polygon fill=\"none\" points=\"437.99,-906.85 383.99,-906.85 383.99,-870.85 437.99,-870.85 437.99,-906.85\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"410.99\" y=\"-885.15\">0</text>\n",
       "</g>\n",
       "<!-- 8767080603036132088&#45;&gt;&#45;4585936485244960297 -->\n",
       "<g class=\"edge\" id=\"edge22\">\n",
       "<title>8767080603036132088-&gt;-4585936485244960297</title>\n",
       "<path d=\"M410.99,-835.16C410.99,-843.42 410.99,-852.3 410.99,-860.38\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"407.49,-860.41 410.99,-870.41 414.49,-860.41 407.49,-860.41\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;2655152137836847089 -->\n",
       "<g class=\"node\" id=\"node26\">\n",
       "<title>-2655152137836847089</title>\n",
       "<ellipse cx=\"172.99\" cy=\"-1003.95\" fill=\"none\" rx=\"61.19\" ry=\"61.19\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"172.99\" y=\"-1000.25\">repartition</text>\n",
       "</g>\n",
       "<!-- &#45;4585936485244960297&#45;&gt;&#45;2655152137836847089 -->\n",
       "<g class=\"edge\" id=\"edge25\">\n",
       "<title>-4585936485244960297-&gt;-2655152137836847089</title>\n",
       "<path d=\"M383.88,-898.16C354.8,-907.48 307.58,-923.82 268.99,-942.85 256.65,-948.94 243.87,-956.2 231.83,-963.52\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"229.87,-960.62 223.21,-968.85 233.55,-966.57 229.87,-960.62\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;8826530809459224764 -->\n",
       "<g class=\"node\" id=\"node27\">\n",
       "<title>-8826530809459224764</title>\n",
       "<ellipse cx=\"338.99\" cy=\"-1003.95\" fill=\"none\" rx=\"61.19\" ry=\"61.19\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"338.99\" y=\"-1000.25\">repartition</text>\n",
       "</g>\n",
       "<!-- &#45;4585936485244960297&#45;&gt;&#45;8826530809459224764 -->\n",
       "<g class=\"edge\" id=\"edge27\">\n",
       "<title>-4585936485244960297-&gt;-8826530809459224764</title>\n",
       "<path d=\"M400.06,-907.03C393.8,-916.87 385.53,-929.85 377.11,-943.08\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"373.99,-941.47 371.57,-951.78 379.89,-945.23 373.99,-941.47\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;5456421442147336739 -->\n",
       "<g class=\"node\" id=\"node28\">\n",
       "<title>-5456421442147336739</title>\n",
       "<ellipse cx=\"482.99\" cy=\"-1003.95\" fill=\"none\" rx=\"61.19\" ry=\"61.19\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"482.99\" y=\"-1000.25\">repartition</text>\n",
       "</g>\n",
       "<!-- &#45;4585936485244960297&#45;&gt;&#45;5456421442147336739 -->\n",
       "<g class=\"edge\" id=\"edge29\">\n",
       "<title>-4585936485244960297-&gt;-5456421442147336739</title>\n",
       "<path d=\"M421.93,-907.03C428.19,-916.87 436.46,-929.85 444.88,-943.08\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"442.09,-945.23 450.42,-951.78 448,-941.47 442.09,-945.23\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;1347603876853171214 -->\n",
       "<g class=\"node\" id=\"node29\">\n",
       "<title>-1347603876853171214</title>\n",
       "<ellipse cx=\"639.99\" cy=\"-1003.95\" fill=\"none\" rx=\"61.19\" ry=\"61.19\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"639.99\" y=\"-1000.25\">repartition</text>\n",
       "</g>\n",
       "<!-- &#45;4585936485244960297&#45;&gt;&#45;1347603876853171214 -->\n",
       "<g class=\"edge\" id=\"edge31\">\n",
       "<title>-4585936485244960297-&gt;-1347603876853171214</title>\n",
       "<path d=\"M438,-897.74C467.21,-906.76 514.73,-922.89 552.99,-942.85 563.06,-948.11 573.35,-954.33 583.15,-960.75\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"581.37,-963.77 591.63,-966.42 585.27,-957.95 581.37,-963.77\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 2127301029613518641 -->\n",
       "<g class=\"node\" id=\"node25\">\n",
       "<title>2127301029613518641</title>\n",
       "<polygon fill=\"none\" points=\"437.99,-736.46 383.99,-736.46 383.99,-700.46 437.99,-700.46 437.99,-736.46\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"410.99\" y=\"-714.76\">0</text>\n",
       "</g>\n",
       "<!-- 2127301029613518641&#45;&gt;8767080603036132088 -->\n",
       "<g class=\"edge\" id=\"edge23\">\n",
       "<title>2127301029613518641-&gt;8767080603036132088</title>\n",
       "<path d=\"M410.99,-736.7C410.99,-744.17 410.99,-753.26 410.99,-762.27\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"407.49,-762.32 410.99,-772.32 414.49,-762.32 407.49,-762.32\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;2655152137836847089&#45;&gt;&#45;8969330059910692832 -->\n",
       "<g class=\"edge\" id=\"edge24\">\n",
       "<title>-2655152137836847089-&gt;-8969330059910692832</title>\n",
       "<path d=\"M157.55,-1063.15C154.94,-1073 152.34,-1082.79 150.08,-1091.31\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"146.7,-1090.43 147.52,-1100.99 153.46,-1092.22 146.7,-1090.43\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;8826530809459224764&#45;&gt;&#45;8969330059911775357 -->\n",
       "<g class=\"edge\" id=\"edge26\">\n",
       "<title>-8826530809459224764-&gt;-8969330059911775357</title>\n",
       "<path d=\"M331.05,-1064.81C329.85,-1073.84 328.67,-1082.76 327.63,-1090.64\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"324.14,-1090.29 326.3,-1100.66 331.08,-1091.21 324.14,-1090.29\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;5456421442147336739&#45;&gt;&#45;8969330059908527782 -->\n",
       "<g class=\"edge\" id=\"edge28\">\n",
       "<title>-5456421442147336739-&gt;-8969330059908527782</title>\n",
       "<path d=\"M482.99,-1065.14C482.99,-1074.03 482.99,-1082.8 482.99,-1090.57\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"479.49,-1090.79 482.99,-1100.79 486.49,-1090.79 479.49,-1090.79\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;1347603876853171214&#45;&gt;&#45;8969330059909610307 -->\n",
       "<g class=\"edge\" id=\"edge30\">\n",
       "<title>-1347603876853171214-&gt;-8969330059909610307</title>\n",
       "<path d=\"M641.59,-1065.14C641.82,-1074.03 642.06,-1082.8 642.26,-1090.57\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"638.77,-1090.88 642.53,-1100.79 645.77,-1090.7 638.77,-1090.88\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;6777544993685073175 -->\n",
       "<g class=\"node\" id=\"node30\">\n",
       "<title>-6777544993685073175</title>\n",
       "<ellipse cx=\"410.99\" cy=\"-320.53\" fill=\"none\" rx=\"92.88\" ry=\"92.88\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"410.99\" y=\"-316.83\">pandas_read_text</text>\n",
       "</g>\n",
       "<!-- 5937717198608485174 -->\n",
       "<g class=\"node\" id=\"node31\">\n",
       "<title>5937717198608485174</title>\n",
       "<polygon fill=\"none\" points=\"437.99,-485.47 383.99,-485.47 383.99,-449.47 437.99,-449.47 437.99,-485.47\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;6777544993685073175&#45;&gt;5937717198608485174 -->\n",
       "<g class=\"edge\" id=\"edge32\">\n",
       "<title>-6777544993685073175-&gt;5937717198608485174</title>\n",
       "<path d=\"M410.99,-413.74C410.99,-422.99 410.99,-431.79 410.99,-439.45\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"407.49,-439.45 410.99,-449.45 414.49,-439.45 407.49,-439.45\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;5919802682464279882 -->\n",
       "<g class=\"node\" id=\"node34\">\n",
       "<title>-5919802682464279882</title>\n",
       "<ellipse cx=\"410.99\" cy=\"-592.97\" fill=\"none\" rx=\"71.49\" ry=\"71.49\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"410.99\" y=\"-589.27\">from-delayed</text>\n",
       "</g>\n",
       "<!-- 5937717198608485174&#45;&gt;&#45;5919802682464279882 -->\n",
       "<g class=\"edge\" id=\"edge36\">\n",
       "<title>5937717198608485174-&gt;-5919802682464279882</title>\n",
       "<path d=\"M410.99,-485.64C410.99,-492.78 410.99,-501.61 410.99,-511.11\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"407.49,-511.21 410.99,-521.21 414.49,-511.21 407.49,-511.21\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;1933836034488598663 -->\n",
       "<g class=\"node\" id=\"node32\">\n",
       "<title>-1933836034488598663</title>\n",
       "<polygon fill=\"none\" points=\"437.99,-191.59 383.99,-191.59 383.99,-155.59 437.99,-155.59 437.99,-191.59\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;1933836034488598663&#45;&gt;&#45;6777544993685073175 -->\n",
       "<g class=\"edge\" id=\"edge33\">\n",
       "<title>-1933836034488598663-&gt;-6777544993685073175</title>\n",
       "<path d=\"M410.99,-191.79C410.99,-198.8 410.99,-207.51 410.99,-217.07\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"407.49,-217.3 410.99,-227.3 414.49,-217.3 407.49,-217.3\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;4358722756815397362 -->\n",
       "<g class=\"node\" id=\"node33\">\n",
       "<title>-4358722756815397362</title>\n",
       "<ellipse cx=\"410.99\" cy=\"-59.79\" fill=\"none\" rx=\"59.59\" ry=\"59.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"410.99\" y=\"-56.09\">read-block</text>\n",
       "</g>\n",
       "<!-- &#45;4358722756815397362&#45;&gt;&#45;1933836034488598663 -->\n",
       "<g class=\"edge\" id=\"edge34\">\n",
       "<title>-4358722756815397362-&gt;-1933836034488598663</title>\n",
       "<path d=\"M410.99,-119.64C410.99,-128.51 410.99,-137.27 410.99,-145.05\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"407.49,-145.28 410.99,-155.28 414.49,-145.28 407.49,-145.28\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;5919802682464279882&#45;&gt;2127301029613518641 -->\n",
       "<g class=\"edge\" id=\"edge35\">\n",
       "<title>-5919802682464279882-&gt;2127301029613518641</title>\n",
       "<path d=\"M410.99,-664.73C410.99,-673.67 410.99,-682.35 410.99,-690\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"407.49,-690.05 410.99,-700.05 414.49,-690.05 407.49,-690.05\" stroke=\"black\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>"
      ],
      "text/plain": [
       "<IPython.core.display.SVG object>"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Instead of getting the actual value we see dd.Scalar, which represents a recipe for actually calculating this value\n",
    "last_eruption_year_min.visualize(format='svg')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "-10450.0"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# To get the value call the 'compute method'\n",
    "# NOTE: this was slower than using pandas directly,,, for small data you often don't need to use parallel computing!\n",
    "last_eruption_year_min.compute()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Dask Arrays\n",
    "\n",
    "A dask array looks and feels a lot like a numpy array.\n",
    "However, a dask array doesn't directly hold any data.\n",
    "Instead, it symbolically represents the computations needed to generate the data.\n",
    "Nothing is actually computed until the actual numerical values are needed.\n",
    "This mode of operation is called \"lazy\"; it allows one to build up complex, large calculations symbolically before turning them over the scheduler for execution.\n",
    "\n",
    "If we want to create a numpy array of all ones, we do it like this:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[1., 1., 1., ..., 1., 1., 1.],\n",
       "       [1., 1., 1., ..., 1., 1., 1.],\n",
       "       [1., 1., 1., ..., 1., 1., 1.],\n",
       "       ...,\n",
       "       [1., 1., 1., ..., 1., 1., 1.],\n",
       "       [1., 1., 1., ..., 1., 1., 1.],\n",
       "       [1., 1., 1., ..., 1., 1., 1.]])"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import numpy as np\n",
    "shape = (1000, 4000)\n",
    "ones_np = np.ones(shape)\n",
    "ones_np"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This array contains exactly 32 MB of data:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "32.0 MB\n"
     ]
    }
   ],
   "source": [
    "print('%.1f MB' % (ones_np.nbytes / 1e6))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now let's create the same array using dask's array interface."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<tr>\n",
       "<td>\n",
       "<table>\n",
       "  <thead>\n",
       "    <tr><td> </td><th> Array </th><th> Chunk </th></tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr><th> Bytes </th><td> 32.00 MB </td> <td> 32.00 MB </td></tr>\n",
       "    <tr><th> Shape </th><td> (1000, 4000) </td> <td> (1000, 4000) </td></tr>\n",
       "    <tr><th> Count </th><td> 1 Tasks </td><td> 1 Chunks </td></tr>\n",
       "    <tr><th> Type </th><td> float64 </td><td> numpy.ndarray </td></tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</td>\n",
       "<td>\n",
       "<svg width=\"170\" height=\"92\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"120\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"0\" y1=\"42\" x2=\"120\" y2=\"42\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"42\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"120\" y1=\"0\" x2=\"120\" y2=\"42\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"0.000000,0.000000 120.000000,0.000000 120.000000,42.898796 0.000000,42.898796\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"60.000000\" y=\"62.898796\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >4000</text>\n",
       "  <text x=\"140.000000\" y=\"21.449398\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,140.000000,21.449398)\">1000</text>\n",
       "</svg>\n",
       "</td>\n",
       "</tr>\n",
       "</table>"
      ],
      "text/plain": [
       "dask.array<ones, shape=(1000, 4000), dtype=float64, chunksize=(1000, 4000), chunktype=numpy.ndarray>"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import dask.array as da\n",
    "ones = da.ones(shape)\n",
    "ones"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This works, but we didn't tell dask how to split up the array, so it is not optimized for distributed computation.\n",
    "\n",
    "A crucal difference with dask is that we must specify the `chunks` argument. \"Chunks\" describes how the array is split up over many sub-arrays.\n",
    "\n",
    "![Dask Arrays](http://dask.pydata.org/en/latest/_images/dask-array-black-text.svg)\n",
    "_source: [Dask Array Documentation](http://dask.pydata.org/en/latest/array-overview.html)_\n",
    "\n",
    "There are [several ways to specify chunks](http://dask.pydata.org/en/latest/array-creation.html#chunks).\n",
    "In this lecture, we will use a block shape."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<tr>\n",
       "<td>\n",
       "<table>\n",
       "  <thead>\n",
       "    <tr><td> </td><th> Array </th><th> Chunk </th></tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr><th> Bytes </th><td> 32.00 MB </td> <td> 8.00 MB </td></tr>\n",
       "    <tr><th> Shape </th><td> (1000, 4000) </td> <td> (1000, 1000) </td></tr>\n",
       "    <tr><th> Count </th><td> 4 Tasks </td><td> 4 Chunks </td></tr>\n",
       "    <tr><th> Type </th><td> float64 </td><td> numpy.ndarray </td></tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</td>\n",
       "<td>\n",
       "<svg width=\"170\" height=\"92\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"120\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"0\" y1=\"42\" x2=\"120\" y2=\"42\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"42\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"30\" y1=\"0\" x2=\"30\" y2=\"42\" />\n",
       "  <line x1=\"60\" y1=\"0\" x2=\"60\" y2=\"42\" />\n",
       "  <line x1=\"90\" y1=\"0\" x2=\"90\" y2=\"42\" />\n",
       "  <line x1=\"120\" y1=\"0\" x2=\"120\" y2=\"42\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"0.000000,0.000000 120.000000,0.000000 120.000000,42.898796 0.000000,42.898796\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"60.000000\" y=\"62.898796\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >4000</text>\n",
       "  <text x=\"140.000000\" y=\"21.449398\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,140.000000,21.449398)\">1000</text>\n",
       "</svg>\n",
       "</td>\n",
       "</tr>\n",
       "</table>"
      ],
      "text/plain": [
       "dask.array<ones, shape=(1000, 4000), dtype=float64, chunksize=(1000, 1000), chunktype=numpy.ndarray>"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "chunk_shape = (1000, 1000)\n",
    "ones = da.ones(shape, chunks=chunk_shape)\n",
    "ones"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Notice that we just see a symbolic represetnation of the array, including its shape, dtype, and chunksize.\n",
    "No data has been generated yet.\n",
    "When we call `.compute()` on a dask array, the computation is trigger and the dask array becomes a numpy array."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[1., 1., 1., ..., 1., 1., 1.],\n",
       "       [1., 1., 1., ..., 1., 1., 1.],\n",
       "       [1., 1., 1., ..., 1., 1., 1.],\n",
       "       ...,\n",
       "       [1., 1., 1., ..., 1., 1., 1.],\n",
       "       [1., 1., 1., ..., 1., 1., 1.],\n",
       "       [1., 1., 1., ..., 1., 1., 1.]])"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ones.compute()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In order to understand what happened when we called `.compute()`, we can visualize the dask _graph_, the symbolic operations that make up the array"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<svg height=\"145pt\" viewBox=\"0.00 0.00 321.99 144.99\" width=\"322pt\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g class=\"graph\" id=\"graph0\" transform=\"scale(1 1) rotate(0) translate(4 140.99)\">\n",
       "<title>%3</title>\n",
       "<polygon fill=\"white\" points=\"-4,4 -4,-140.99 317.99,-140.99 317.99,4 -4,4\" stroke=\"transparent\"/>\n",
       "<!-- &#45;1467910790690776579 -->\n",
       "<g class=\"node\" id=\"node1\">\n",
       "<title>-1467910790690776579</title>\n",
       "<ellipse cx=\"32.5\" cy=\"-32.5\" fill=\"none\" rx=\"32.49\" ry=\"32.49\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"32.5\" y=\"-28.8\">ones</text>\n",
       "</g>\n",
       "<!-- 5581130617534253882 -->\n",
       "<g class=\"node\" id=\"node2\">\n",
       "<title>5581130617534253882</title>\n",
       "<polygon fill=\"none\" points=\"59.5,-136.99 5.5,-136.99 5.5,-100.99 59.5,-100.99 59.5,-136.99\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"32.5\" y=\"-115.29\">(0, 0)</text>\n",
       "</g>\n",
       "<!-- &#45;1467910790690776579&#45;&gt;5581130617534253882 -->\n",
       "<g class=\"edge\" id=\"edge1\">\n",
       "<title>-1467910790690776579-&gt;5581130617534253882</title>\n",
       "<path d=\"M32.5,-65.44C32.5,-73.67 32.5,-82.45 32.5,-90.43\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"29,-90.69 32.5,-100.69 36,-90.69 29,-90.69\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;1090831373445564154 -->\n",
       "<g class=\"node\" id=\"node3\">\n",
       "<title>-1090831373445564154</title>\n",
       "<ellipse cx=\"115.5\" cy=\"-32.5\" fill=\"none\" rx=\"32.49\" ry=\"32.49\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"115.5\" y=\"-28.8\">ones</text>\n",
       "</g>\n",
       "<!-- 5581130617533088833 -->\n",
       "<g class=\"node\" id=\"node4\">\n",
       "<title>5581130617533088833</title>\n",
       "<polygon fill=\"none\" points=\"142.5,-136.99 88.5,-136.99 88.5,-100.99 142.5,-100.99 142.5,-136.99\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"115.5\" y=\"-115.29\">(0, 1)</text>\n",
       "</g>\n",
       "<!-- &#45;1090831373445564154&#45;&gt;5581130617533088833 -->\n",
       "<g class=\"edge\" id=\"edge2\">\n",
       "<title>-1090831373445564154-&gt;5581130617533088833</title>\n",
       "<path d=\"M115.5,-65.44C115.5,-73.67 115.5,-82.45 115.5,-90.43\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"112,-90.69 115.5,-100.69 119,-90.69 112,-90.69\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 1062196149202694471 -->\n",
       "<g class=\"node\" id=\"node5\">\n",
       "<title>1062196149202694471</title>\n",
       "<ellipse cx=\"198.5\" cy=\"-32.5\" fill=\"none\" rx=\"32.49\" ry=\"32.49\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"198.5\" y=\"-28.8\">ones</text>\n",
       "</g>\n",
       "<!-- 5581130617531923784 -->\n",
       "<g class=\"node\" id=\"node6\">\n",
       "<title>5581130617531923784</title>\n",
       "<polygon fill=\"none\" points=\"225.5,-136.99 171.5,-136.99 171.5,-100.99 225.5,-100.99 225.5,-136.99\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"198.5\" y=\"-115.29\">(0, 2)</text>\n",
       "</g>\n",
       "<!-- 1062196149202694471&#45;&gt;5581130617531923784 -->\n",
       "<g class=\"edge\" id=\"edge3\">\n",
       "<title>1062196149202694471-&gt;5581130617531923784</title>\n",
       "<path d=\"M198.5,-65.44C198.5,-73.67 198.5,-82.45 198.5,-90.43\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"195,-90.69 198.5,-100.69 202,-90.69 195,-90.69\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;5179843938900528704 -->\n",
       "<g class=\"node\" id=\"node7\">\n",
       "<title>-5179843938900528704</title>\n",
       "<ellipse cx=\"281.5\" cy=\"-32.5\" fill=\"none\" rx=\"32.49\" ry=\"32.49\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"281.5\" y=\"-28.8\">ones</text>\n",
       "</g>\n",
       "<!-- 5581130617530758735 -->\n",
       "<g class=\"node\" id=\"node8\">\n",
       "<title>5581130617530758735</title>\n",
       "<polygon fill=\"none\" points=\"308.5,-136.99 254.5,-136.99 254.5,-100.99 308.5,-100.99 308.5,-136.99\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"281.5\" y=\"-115.29\">(0, 3)</text>\n",
       "</g>\n",
       "<!-- &#45;5179843938900528704&#45;&gt;5581130617530758735 -->\n",
       "<g class=\"edge\" id=\"edge4\">\n",
       "<title>-5179843938900528704-&gt;5581130617530758735</title>\n",
       "<path d=\"M281.5,-65.44C281.5,-73.67 281.5,-82.45 281.5,-90.43\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"278,-90.69 281.5,-100.69 285,-90.69 278,-90.69\" stroke=\"black\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>"
      ],
      "text/plain": [
       "<IPython.core.display.SVG object>"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ones.visualize(format='svg')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Our array has four chunks. To generate it, dask calls `np.ones` four times and then concatenates this together into one array.\n",
    "\n",
    "Rather than immediately loading a dask array (which puts all the data into RAM), it is more common to reduce the data somehow. For example:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<svg height=\"819pt\" viewBox=\"0.00 0.00 349.99 818.66\" width=\"350pt\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g class=\"graph\" id=\"graph0\" transform=\"scale(1 1) rotate(0) translate(4 814.66)\">\n",
       "<title>%3</title>\n",
       "<polygon fill=\"white\" points=\"-4,4 -4,-814.66 345.99,-814.66 345.99,4 -4,4\" stroke=\"transparent\"/>\n",
       "<!-- 2433749135008548631 -->\n",
       "<g class=\"node\" id=\"node1\">\n",
       "<title>2433749135008548631</title>\n",
       "<ellipse cx=\"170.5\" cy=\"-658.07\" fill=\"none\" rx=\"80.69\" ry=\"80.69\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"170.5\" y=\"-654.37\">sum-aggregate</text>\n",
       "</g>\n",
       "<!-- &#45;3318625691064969512 -->\n",
       "<g class=\"node\" id=\"node2\">\n",
       "<title>-3318625691064969512</title>\n",
       "<polygon fill=\"none\" points=\"197.5,-810.66 143.5,-810.66 143.5,-774.66 197.5,-774.66 197.5,-810.66\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"170.5\" y=\"-788.96\">()</text>\n",
       "</g>\n",
       "<!-- 2433749135008548631&#45;&gt;&#45;3318625691064969512 -->\n",
       "<g class=\"edge\" id=\"edge1\">\n",
       "<title>2433749135008548631-&gt;-3318625691064969512</title>\n",
       "<path d=\"M170.5,-738.88C170.5,-747.97 170.5,-756.72 170.5,-764.38\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"167,-764.42 170.5,-774.42 174,-764.42 167,-764.42\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;9037160198514385883 -->\n",
       "<g class=\"node\" id=\"node3\">\n",
       "<title>-9037160198514385883</title>\n",
       "<polygon fill=\"none\" points=\"161.5,-541.48 107.5,-541.48 107.5,-505.48 161.5,-505.48 161.5,-541.48\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"134.5\" y=\"-519.78\">(0, 1)</text>\n",
       "</g>\n",
       "<!-- &#45;9037160198514385883&#45;&gt;2433749135008548631 -->\n",
       "<g class=\"edge\" id=\"edge2\">\n",
       "<title>-9037160198514385883-&gt;2433749135008548631</title>\n",
       "<path d=\"M139.13,-541.54C141.27,-549.44 144,-559.47 146.94,-570.32\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"143.58,-571.29 149.58,-580.02 150.33,-569.45 143.58,-571.29\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;9037160198513220834 -->\n",
       "<g class=\"node\" id=\"node4\">\n",
       "<title>-9037160198513220834</title>\n",
       "<polygon fill=\"none\" points=\"251.5,-541.48 197.5,-541.48 197.5,-505.48 251.5,-505.48 251.5,-541.48\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"224.5\" y=\"-519.78\">(0, 0)</text>\n",
       "</g>\n",
       "<!-- &#45;9037160198513220834&#45;&gt;2433749135008548631 -->\n",
       "<g class=\"edge\" id=\"edge3\">\n",
       "<title>-9037160198513220834-&gt;2433749135008548631</title>\n",
       "<path d=\"M217.55,-541.54C214.01,-550.24 209.41,-561.52 204.48,-573.62\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"201.19,-572.42 200.66,-583.01 207.67,-575.06 201.19,-572.42\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 1127403756371291873 -->\n",
       "<g class=\"node\" id=\"node5\">\n",
       "<title>1127403756371291873</title>\n",
       "<ellipse cx=\"243.5\" cy=\"-405.78\" fill=\"none\" rx=\"63.89\" ry=\"63.89\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"243.5\" y=\"-402.08\">sum-partial</text>\n",
       "</g>\n",
       "<!-- 1127403756371291873&#45;&gt;&#45;9037160198513220834 -->\n",
       "<g class=\"edge\" id=\"edge4\">\n",
       "<title>1127403756371291873-&gt;-9037160198513220834</title>\n",
       "<path d=\"M233.33,-468.69C231.78,-478.11 230.26,-487.38 228.93,-495.5\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"225.46,-494.99 227.3,-505.43 232.37,-496.13 225.46,-494.99\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 7156700612518248265 -->\n",
       "<g class=\"node\" id=\"node6\">\n",
       "<title>7156700612518248265</title>\n",
       "<polygon fill=\"none\" points=\"257.5,-306.09 203.5,-306.09 203.5,-270.09 257.5,-270.09 257.5,-306.09\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"230.5\" y=\"-284.39\">(0, 1)</text>\n",
       "</g>\n",
       "<!-- 7156700612518248265&#45;&gt;1127403756371291873 -->\n",
       "<g class=\"edge\" id=\"edge5\">\n",
       "<title>7156700612518248265-&gt;1127403756371291873</title>\n",
       "<path d=\"M232.42,-306.16C233.23,-313.44 234.25,-322.47 235.33,-332.08\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"231.88,-332.72 236.47,-342.27 238.83,-331.94 231.88,-332.72\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 7156700612519413314 -->\n",
       "<g class=\"node\" id=\"node7\">\n",
       "<title>7156700612519413314</title>\n",
       "<polygon fill=\"none\" points=\"333.5,-306.09 279.5,-306.09 279.5,-270.09 333.5,-270.09 333.5,-306.09\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"306.5\" y=\"-284.39\">(0, 0)</text>\n",
       "</g>\n",
       "<!-- 7156700612519413314&#45;&gt;1127403756371291873 -->\n",
       "<g class=\"edge\" id=\"edge6\">\n",
       "<title>7156700612519413314-&gt;1127403756371291873</title>\n",
       "<path d=\"M297.2,-306.16C292.08,-315.56 285.38,-327.87 278.44,-340.61\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"275.33,-339 273.62,-349.46 281.48,-342.35 275.33,-339\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 314947645646318698 -->\n",
       "<g class=\"node\" id=\"node8\">\n",
       "<title>314947645646318698</title>\n",
       "<ellipse cx=\"98.5\" cy=\"-405.78\" fill=\"none\" rx=\"63.89\" ry=\"63.89\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"98.5\" y=\"-402.08\">sum-partial</text>\n",
       "</g>\n",
       "<!-- 314947645646318698&#45;&gt;&#45;9037160198514385883 -->\n",
       "<g class=\"edge\" id=\"edge7\">\n",
       "<title>314947645646318698-&gt;-9037160198514385883</title>\n",
       "<path d=\"M117.24,-467C120.34,-477 123.42,-486.89 126.1,-495.5\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"122.83,-496.77 129.15,-505.28 129.52,-494.69 122.83,-496.77\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 7156700612517083216 -->\n",
       "<g class=\"node\" id=\"node9\">\n",
       "<title>7156700612517083216</title>\n",
       "<polygon fill=\"none\" points=\"63.5,-306.09 9.5,-306.09 9.5,-270.09 63.5,-270.09 63.5,-306.09\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"36.5\" y=\"-284.39\">(0, 2)</text>\n",
       "</g>\n",
       "<!-- 7156700612517083216&#45;&gt;314947645646318698 -->\n",
       "<g class=\"edge\" id=\"edge8\">\n",
       "<title>7156700612517083216-&gt;314947645646318698</title>\n",
       "<path d=\"M45.65,-306.16C50.61,-315.42 57.08,-327.51 63.8,-340.03\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"60.9,-342.04 68.71,-349.2 67.07,-338.73 60.9,-342.04\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 7156700612515918167 -->\n",
       "<g class=\"node\" id=\"node10\">\n",
       "<title>7156700612515918167</title>\n",
       "<polygon fill=\"none\" points=\"137.5,-306.09 83.5,-306.09 83.5,-270.09 137.5,-270.09 137.5,-306.09\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"110.5\" y=\"-284.39\">(0, 3)</text>\n",
       "</g>\n",
       "<!-- 7156700612515918167&#45;&gt;314947645646318698 -->\n",
       "<g class=\"edge\" id=\"edge9\">\n",
       "<title>7156700612515918167-&gt;314947645646318698</title>\n",
       "<path d=\"M108.73,-306.16C107.97,-313.44 107.04,-322.47 106.04,-332.08\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"102.53,-331.96 104.98,-342.27 109.49,-332.68 102.53,-331.96\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 5140465954441123125 -->\n",
       "<g class=\"node\" id=\"node11\">\n",
       "<title>5140465954441123125</title>\n",
       "<ellipse cx=\"308.5\" cy=\"-203.54\" fill=\"none\" rx=\"30.59\" ry=\"30.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"308.5\" y=\"-199.84\">sum</text>\n",
       "</g>\n",
       "<!-- 5140465954441123125&#45;&gt;7156700612519413314 -->\n",
       "<g class=\"edge\" id=\"edge10\">\n",
       "<title>5140465954441123125-&gt;7156700612519413314</title>\n",
       "<path d=\"M307.78,-234.34C307.57,-242.69 307.35,-251.72 307.16,-259.91\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"303.65,-259.98 306.91,-270.06 310.65,-260.15 303.65,-259.98\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 5581130617534253882 -->\n",
       "<g class=\"node\" id=\"node12\">\n",
       "<title>5581130617534253882</title>\n",
       "<polygon fill=\"none\" points=\"335.5,-136.99 281.5,-136.99 281.5,-100.99 335.5,-100.99 335.5,-136.99\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"308.5\" y=\"-115.29\">(0, 0)</text>\n",
       "</g>\n",
       "<!-- 5581130617534253882&#45;&gt;5140465954441123125 -->\n",
       "<g class=\"edge\" id=\"edge11\">\n",
       "<title>5581130617534253882-&gt;5140465954441123125</title>\n",
       "<path d=\"M308.5,-137.1C308.5,-144.58 308.5,-153.69 308.5,-162.72\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"305,-162.77 308.5,-172.77 312,-162.77 305,-162.77\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;4725455469457657250 -->\n",
       "<g class=\"node\" id=\"node13\">\n",
       "<title>-4725455469457657250</title>\n",
       "<ellipse cx=\"228.5\" cy=\"-203.54\" fill=\"none\" rx=\"30.59\" ry=\"30.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"228.5\" y=\"-199.84\">sum</text>\n",
       "</g>\n",
       "<!-- &#45;4725455469457657250&#45;&gt;7156700612518248265 -->\n",
       "<g class=\"edge\" id=\"edge12\">\n",
       "<title>-4725455469457657250-&gt;7156700612518248265</title>\n",
       "<path d=\"M229.22,-234.34C229.42,-242.69 229.64,-251.72 229.84,-259.91\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"226.34,-260.15 230.08,-270.06 233.34,-259.98 226.34,-260.15\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 5581130617533088833 -->\n",
       "<g class=\"node\" id=\"node14\">\n",
       "<title>5581130617533088833</title>\n",
       "<polygon fill=\"none\" points=\"253.5,-136.99 199.5,-136.99 199.5,-100.99 253.5,-100.99 253.5,-136.99\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"226.5\" y=\"-115.29\">(0, 1)</text>\n",
       "</g>\n",
       "<!-- 5581130617533088833&#45;&gt;&#45;4725455469457657250 -->\n",
       "<g class=\"edge\" id=\"edge13\">\n",
       "<title>5581130617533088833-&gt;-4725455469457657250</title>\n",
       "<path d=\"M226.91,-137.1C227.09,-144.58 227.31,-153.69 227.53,-162.72\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"224.03,-162.86 227.78,-172.77 231.03,-162.69 224.03,-162.86\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;1837246662055191425 -->\n",
       "<g class=\"node\" id=\"node15\">\n",
       "<title>-1837246662055191425</title>\n",
       "<ellipse cx=\"34.5\" cy=\"-203.54\" fill=\"none\" rx=\"30.59\" ry=\"30.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"34.5\" y=\"-199.84\">sum</text>\n",
       "</g>\n",
       "<!-- &#45;1837246662055191425&#45;&gt;7156700612517083216 -->\n",
       "<g class=\"edge\" id=\"edge14\">\n",
       "<title>-1837246662055191425-&gt;7156700612517083216</title>\n",
       "<path d=\"M35.22,-234.34C35.42,-242.69 35.64,-251.72 35.84,-259.91\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"32.34,-260.15 36.08,-270.06 39.34,-259.98 32.34,-260.15\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 5581130617531923784 -->\n",
       "<g class=\"node\" id=\"node16\">\n",
       "<title>5581130617531923784</title>\n",
       "<polygon fill=\"none\" points=\"60.5,-136.99 6.5,-136.99 6.5,-100.99 60.5,-100.99 60.5,-136.99\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"33.5\" y=\"-115.29\">(0, 2)</text>\n",
       "</g>\n",
       "<!-- 5581130617531923784&#45;&gt;&#45;1837246662055191425 -->\n",
       "<g class=\"edge\" id=\"edge15\">\n",
       "<title>5581130617531923784-&gt;-1837246662055191425</title>\n",
       "<path d=\"M33.7,-137.1C33.79,-144.58 33.91,-153.69 34.01,-162.72\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"30.52,-162.81 34.14,-172.77 37.51,-162.73 30.52,-162.81\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;1496144773786405000 -->\n",
       "<g class=\"node\" id=\"node17\">\n",
       "<title>-1496144773786405000</title>\n",
       "<ellipse cx=\"113.5\" cy=\"-203.54\" fill=\"none\" rx=\"30.59\" ry=\"30.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"113.5\" y=\"-199.84\">sum</text>\n",
       "</g>\n",
       "<!-- &#45;1496144773786405000&#45;&gt;7156700612515918167 -->\n",
       "<g class=\"edge\" id=\"edge16\">\n",
       "<title>-1496144773786405000-&gt;7156700612515918167</title>\n",
       "<path d=\"M112.41,-234.34C112.11,-242.69 111.78,-251.72 111.48,-259.91\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"107.98,-259.94 111.12,-270.06 114.98,-260.19 107.98,-259.94\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 5581130617530758735 -->\n",
       "<g class=\"node\" id=\"node18\">\n",
       "<title>5581130617530758735</title>\n",
       "<polygon fill=\"none\" points=\"140.5,-136.99 86.5,-136.99 86.5,-100.99 140.5,-100.99 140.5,-136.99\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"113.5\" y=\"-115.29\">(0, 3)</text>\n",
       "</g>\n",
       "<!-- 5581130617530758735&#45;&gt;&#45;1496144773786405000 -->\n",
       "<g class=\"edge\" id=\"edge17\">\n",
       "<title>5581130617530758735-&gt;-1496144773786405000</title>\n",
       "<path d=\"M113.5,-137.1C113.5,-144.58 113.5,-153.69 113.5,-162.72\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"110,-162.77 113.5,-172.77 117,-162.77 110,-162.77\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;1467910790690776579 -->\n",
       "<g class=\"node\" id=\"node19\">\n",
       "<title>-1467910790690776579</title>\n",
       "<ellipse cx=\"309.5\" cy=\"-32.5\" fill=\"none\" rx=\"32.49\" ry=\"32.49\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"309.5\" y=\"-28.8\">ones</text>\n",
       "</g>\n",
       "<!-- &#45;1467910790690776579&#45;&gt;5581130617534253882 -->\n",
       "<g class=\"edge\" id=\"edge18\">\n",
       "<title>-1467910790690776579-&gt;5581130617534253882</title>\n",
       "<path d=\"M309.12,-65.44C309.02,-73.67 308.92,-82.45 308.82,-90.43\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"305.32,-90.65 308.7,-100.69 312.32,-90.73 305.32,-90.65\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;1090831373445564154 -->\n",
       "<g class=\"node\" id=\"node20\">\n",
       "<title>-1090831373445564154</title>\n",
       "<ellipse cx=\"226.5\" cy=\"-32.5\" fill=\"none\" rx=\"32.49\" ry=\"32.49\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"226.5\" y=\"-28.8\">ones</text>\n",
       "</g>\n",
       "<!-- &#45;1090831373445564154&#45;&gt;5581130617533088833 -->\n",
       "<g class=\"edge\" id=\"edge19\">\n",
       "<title>-1090831373445564154-&gt;5581130617533088833</title>\n",
       "<path d=\"M226.5,-65.44C226.5,-73.67 226.5,-82.45 226.5,-90.43\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"223,-90.69 226.5,-100.69 230,-90.69 223,-90.69\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 1062196149202694471 -->\n",
       "<g class=\"node\" id=\"node21\">\n",
       "<title>1062196149202694471</title>\n",
       "<ellipse cx=\"32.5\" cy=\"-32.5\" fill=\"none\" rx=\"32.49\" ry=\"32.49\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"32.5\" y=\"-28.8\">ones</text>\n",
       "</g>\n",
       "<!-- 1062196149202694471&#45;&gt;5581130617531923784 -->\n",
       "<g class=\"edge\" id=\"edge20\">\n",
       "<title>1062196149202694471-&gt;5581130617531923784</title>\n",
       "<path d=\"M32.88,-65.44C32.97,-73.67 33.08,-82.45 33.17,-90.43\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"29.67,-90.73 33.29,-100.69 36.67,-90.65 29.67,-90.73\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;5179843938900528704 -->\n",
       "<g class=\"node\" id=\"node22\">\n",
       "<title>-5179843938900528704</title>\n",
       "<ellipse cx=\"115.5\" cy=\"-32.5\" fill=\"none\" rx=\"32.49\" ry=\"32.49\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"115.5\" y=\"-28.8\">ones</text>\n",
       "</g>\n",
       "<!-- &#45;5179843938900528704&#45;&gt;5581130617530758735 -->\n",
       "<g class=\"edge\" id=\"edge21\">\n",
       "<title>-5179843938900528704-&gt;5581130617530758735</title>\n",
       "<path d=\"M114.74,-65.44C114.55,-73.67 114.34,-82.45 114.15,-90.43\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"110.64,-90.61 113.91,-100.69 117.64,-90.78 110.64,-90.61\" stroke=\"black\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>"
      ],
      "text/plain": [
       "<IPython.core.display.SVG object>"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sum_of_ones = ones.sum()\n",
    "sum_of_ones.visualize(format='svg')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Here we see dask's strategy for finding the sum. This simple example illustrates the beauty of dask: it automatically designs an algorithm appropriate for custom operations with big data. \n",
    "\n",
    "If we make our operation more complex, the graph gets more complex."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<svg height=\"1421pt\" viewBox=\"0.00 0.00 618.09 1420.73\" width=\"618pt\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g class=\"graph\" id=\"graph0\" transform=\"scale(1 1) rotate(0) translate(4 1416.73)\">\n",
       "<title>%3</title>\n",
       "<polygon fill=\"white\" points=\"-4,4 -4,-1416.73 614.09,-1416.73 614.09,4 -4,4\" stroke=\"transparent\"/>\n",
       "<!-- 3757600662728737044 -->\n",
       "<g class=\"node\" id=\"node1\">\n",
       "<title>3757600662728737044</title>\n",
       "<ellipse cx=\"237.54\" cy=\"-1232.19\" fill=\"none\" rx=\"108.58\" ry=\"108.58\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"237.54\" y=\"-1228.49\">mean_agg-aggregate</text>\n",
       "</g>\n",
       "<!-- &#45;7642154293811447917 -->\n",
       "<g class=\"node\" id=\"node2\">\n",
       "<title>-7642154293811447917</title>\n",
       "<polygon fill=\"none\" points=\"264.54,-1412.73 210.54,-1412.73 210.54,-1376.73 264.54,-1376.73 264.54,-1412.73\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"237.54\" y=\"-1391.03\">()</text>\n",
       "</g>\n",
       "<!-- 3757600662728737044&#45;&gt;&#45;7642154293811447917 -->\n",
       "<g class=\"edge\" id=\"edge1\">\n",
       "<title>3757600662728737044-&gt;-7642154293811447917</title>\n",
       "<path d=\"M237.54,-1341.16C237.54,-1350.31 237.54,-1358.91 237.54,-1366.4\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"234.04,-1366.51 237.54,-1376.51 241.04,-1366.51 234.04,-1366.51\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 460205287204345669 -->\n",
       "<g class=\"node\" id=\"node3\">\n",
       "<title>460205287204345669</title>\n",
       "<polygon fill=\"none\" points=\"228.54,-1087.65 174.54,-1087.65 174.54,-1051.65 228.54,-1051.65 228.54,-1087.65\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"201.54\" y=\"-1065.95\">(0, 0)</text>\n",
       "</g>\n",
       "<!-- 460205287204345669&#45;&gt;3757600662728737044 -->\n",
       "<g class=\"edge\" id=\"edge2\">\n",
       "<title>460205287204345669-&gt;3757600662728737044</title>\n",
       "<path d=\"M205.4,-1087.83C207.12,-1095.52 209.32,-1105.31 211.75,-1116.14\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"208.33,-1116.91 213.93,-1125.9 215.16,-1115.38 208.33,-1116.91\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 460205287205510718 -->\n",
       "<g class=\"node\" id=\"node4\">\n",
       "<title>460205287205510718</title>\n",
       "<polygon fill=\"none\" points=\"344.54,-1087.65 290.54,-1087.65 290.54,-1051.65 344.54,-1051.65 344.54,-1087.65\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"317.54\" y=\"-1065.95\">(0, 1)</text>\n",
       "</g>\n",
       "<!-- 460205287205510718&#45;&gt;3757600662728737044 -->\n",
       "<g class=\"edge\" id=\"edge3\">\n",
       "<title>460205287205510718-&gt;3757600662728737044</title>\n",
       "<path d=\"M308.98,-1087.83C304.08,-1097.68 297.46,-1110.94 290.23,-1125.45\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"286.99,-1124.11 285.66,-1134.62 293.26,-1127.23 286.99,-1124.11\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 6934690707874628426 -->\n",
       "<g class=\"node\" id=\"node5\">\n",
       "<title>6934690707874628426</title>\n",
       "<ellipse cx=\"114.54\" cy=\"-901.26\" fill=\"none\" rx=\"114.28\" ry=\"114.28\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"114.54\" y=\"-897.56\">mean_combine-partial</text>\n",
       "</g>\n",
       "<!-- 6934690707874628426&#45;&gt;460205287204345669 -->\n",
       "<g class=\"edge\" id=\"edge4\">\n",
       "<title>6934690707874628426-&gt;460205287204345669</title>\n",
       "<path d=\"M167.16,-1002.89C174.74,-1017.39 181.94,-1031.15 187.77,-1042.31\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"184.78,-1044.15 192.52,-1051.39 190.99,-1040.9 184.78,-1044.15\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 329161111580338521 -->\n",
       "<g class=\"node\" id=\"node6\">\n",
       "<title>329161111580338521</title>\n",
       "<polygon fill=\"none\" points=\"102.54,-750.87 48.54,-750.87 48.54,-714.87 102.54,-714.87 102.54,-750.87\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"75.54\" y=\"-729.17\">(0, 0)</text>\n",
       "</g>\n",
       "<!-- 329161111580338521&#45;&gt;6934690707874628426 -->\n",
       "<g class=\"edge\" id=\"edge5\">\n",
       "<title>329161111580338521-&gt;6934690707874628426</title>\n",
       "<path d=\"M79.57,-751.05C81.39,-758.82 83.72,-768.73 86.3,-779.75\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"82.94,-780.75 88.63,-789.69 89.75,-779.15 82.94,-780.75\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 329161111581503570 -->\n",
       "<g class=\"node\" id=\"node7\">\n",
       "<title>329161111581503570</title>\n",
       "<polygon fill=\"none\" points=\"209.54,-750.87 155.54,-750.87 155.54,-714.87 209.54,-714.87 209.54,-750.87\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"182.54\" y=\"-729.17\">(0, 1)</text>\n",
       "</g>\n",
       "<!-- 329161111581503570&#45;&gt;6934690707874628426 -->\n",
       "<g class=\"edge\" id=\"edge6\">\n",
       "<title>329161111581503570-&gt;6934690707874628426</title>\n",
       "<path d=\"M175.52,-751.05C171.8,-760.16 166.87,-772.21 161.43,-785.53\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"158.13,-784.35 157.59,-794.93 164.61,-787 158.13,-784.35\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 4771368369731086401 -->\n",
       "<g class=\"node\" id=\"node8\">\n",
       "<title>4771368369731086401</title>\n",
       "<ellipse cx=\"361.54\" cy=\"-901.26\" fill=\"none\" rx=\"114.28\" ry=\"114.28\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"361.54\" y=\"-897.56\">mean_combine-partial</text>\n",
       "</g>\n",
       "<!-- 4771368369731086401&#45;&gt;460205287205510718 -->\n",
       "<g class=\"edge\" id=\"edge7\">\n",
       "<title>4771368369731086401-&gt;460205287205510718</title>\n",
       "<path d=\"M332.44,-1012.32C329.58,-1023.14 326.89,-1033.29 324.61,-1041.91\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"321.22,-1041.04 322.05,-1051.6 327.99,-1042.83 321.22,-1041.04\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 329161111579173472 -->\n",
       "<g class=\"node\" id=\"node9\">\n",
       "<title>329161111579173472</title>\n",
       "<polygon fill=\"none\" points=\"284.54,-750.87 230.54,-750.87 230.54,-714.87 284.54,-714.87 284.54,-750.87\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"257.54\" y=\"-729.17\">(0, 3)</text>\n",
       "</g>\n",
       "<!-- 329161111579173472&#45;&gt;4771368369731086401 -->\n",
       "<g class=\"edge\" id=\"edge8\">\n",
       "<title>329161111579173472-&gt;4771368369731086401</title>\n",
       "<path d=\"M268.28,-751.05C275.33,-762.32 285.2,-778.11 295.89,-795.23\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"292.94,-797.1 301.2,-803.72 298.87,-793.39 292.94,-797.1\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 329161111578008423 -->\n",
       "<g class=\"node\" id=\"node10\">\n",
       "<title>329161111578008423</title>\n",
       "<polygon fill=\"none\" points=\"477.54,-750.87 423.54,-750.87 423.54,-714.87 477.54,-714.87 477.54,-750.87\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"450.54\" y=\"-729.17\">(0, 2)</text>\n",
       "</g>\n",
       "<!-- 329161111578008423&#45;&gt;4771368369731086401 -->\n",
       "<g class=\"edge\" id=\"edge9\">\n",
       "<title>329161111578008423-&gt;4771368369731086401</title>\n",
       "<path d=\"M441.35,-751.05C435.86,-761.32 428.36,-775.34 420.15,-790.7\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"416.87,-789.41 415.24,-799.88 423.04,-792.71 416.87,-789.41\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;4150313276219710546 -->\n",
       "<g class=\"node\" id=\"node11\">\n",
       "<title>-4150313276219710546</title>\n",
       "<ellipse cx=\"69.54\" cy=\"-609.32\" fill=\"none\" rx=\"69.59\" ry=\"69.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"69.54\" y=\"-605.62\">mean_chunk</text>\n",
       "</g>\n",
       "<!-- &#45;4150313276219710546&#45;&gt;329161111580338521 -->\n",
       "<g class=\"edge\" id=\"edge10\">\n",
       "<title>-4150313276219710546-&gt;329161111580338521</title>\n",
       "<path d=\"M72.93,-678.91C73.38,-687.99 73.81,-696.83 74.2,-704.6\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"70.71,-704.99 74.7,-714.8 77.7,-704.64 70.71,-704.99\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 1639906887577649273 -->\n",
       "<g class=\"node\" id=\"node12\">\n",
       "<title>1639906887577649273</title>\n",
       "<polygon fill=\"none\" points=\"96.54,-503.78 42.54,-503.78 42.54,-467.78 96.54,-467.78 96.54,-503.78\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"69.54\" y=\"-482.08\">(0, 0)</text>\n",
       "</g>\n",
       "<!-- 1639906887577649273&#45;&gt;&#45;4150313276219710546 -->\n",
       "<g class=\"edge\" id=\"edge11\">\n",
       "<title>1639906887577649273-&gt;-4150313276219710546</title>\n",
       "<path d=\"M69.54,-503.94C69.54,-511.13 69.54,-520.03 69.54,-529.59\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"66.04,-529.75 69.54,-539.75 73.04,-529.75 66.04,-529.75\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;7430447925333402171 -->\n",
       "<g class=\"node\" id=\"node13\">\n",
       "<title>-7430447925333402171</title>\n",
       "<ellipse cx=\"383.54\" cy=\"-609.32\" fill=\"none\" rx=\"69.59\" ry=\"69.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"383.54\" y=\"-605.62\">mean_chunk</text>\n",
       "</g>\n",
       "<!-- &#45;7430447925333402171&#45;&gt;329161111581503570 -->\n",
       "<g class=\"edge\" id=\"edge12\">\n",
       "<title>-7430447925333402171-&gt;329161111581503570</title>\n",
       "<path d=\"M333.77,-658.12C324.75,-665.58 315.15,-672.81 305.54,-678.87 271.19,-700.54 258.83,-698.75 221.54,-714.87 220.71,-715.23 219.87,-715.59 219.03,-715.96\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"217.59,-712.77 209.81,-719.96 220.38,-719.19 217.59,-712.77\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 1639906887578814322 -->\n",
       "<g class=\"node\" id=\"node14\">\n",
       "<title>1639906887578814322</title>\n",
       "<polygon fill=\"none\" points=\"410.54,-503.78 356.54,-503.78 356.54,-467.78 410.54,-467.78 410.54,-503.78\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"383.54\" y=\"-482.08\">(0, 1)</text>\n",
       "</g>\n",
       "<!-- 1639906887578814322&#45;&gt;&#45;7430447925333402171 -->\n",
       "<g class=\"edge\" id=\"edge13\">\n",
       "<title>1639906887578814322-&gt;-7430447925333402171</title>\n",
       "<path d=\"M383.54,-503.94C383.54,-511.13 383.54,-520.03 383.54,-529.59\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"380.04,-529.75 383.54,-539.75 387.04,-529.75 380.04,-529.75\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;5895089637240147960 -->\n",
       "<g class=\"node\" id=\"node15\">\n",
       "<title>-5895089637240147960</title>\n",
       "<ellipse cx=\"540.54\" cy=\"-609.32\" fill=\"none\" rx=\"69.59\" ry=\"69.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"540.54\" y=\"-605.62\">mean_chunk</text>\n",
       "</g>\n",
       "<!-- &#45;5895089637240147960&#45;&gt;329161111578008423 -->\n",
       "<g class=\"edge\" id=\"edge14\">\n",
       "<title>-5895089637240147960-&gt;329161111578008423</title>\n",
       "<path d=\"M499.49,-665.76C488.9,-680.07 478.01,-694.78 469.2,-706.67\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"466.32,-704.67 463.19,-714.79 471.95,-708.84 466.32,-704.67\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 1639906887575319175 -->\n",
       "<g class=\"node\" id=\"node16\">\n",
       "<title>1639906887575319175</title>\n",
       "<polygon fill=\"none\" points=\"567.54,-503.78 513.54,-503.78 513.54,-467.78 567.54,-467.78 567.54,-503.78\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"540.54\" y=\"-482.08\">(0, 2)</text>\n",
       "</g>\n",
       "<!-- 1639906887575319175&#45;&gt;&#45;5895089637240147960 -->\n",
       "<g class=\"edge\" id=\"edge15\">\n",
       "<title>1639906887575319175-&gt;-5895089637240147960</title>\n",
       "<path d=\"M540.54,-503.94C540.54,-511.13 540.54,-520.03 540.54,-529.59\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"537.04,-529.75 540.54,-539.75 544.04,-529.75 537.04,-529.75\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;1321855208474239921 -->\n",
       "<g class=\"node\" id=\"node17\">\n",
       "<title>-1321855208474239921</title>\n",
       "<ellipse cx=\"226.54\" cy=\"-609.32\" fill=\"none\" rx=\"69.59\" ry=\"69.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"226.54\" y=\"-605.62\">mean_chunk</text>\n",
       "</g>\n",
       "<!-- &#45;1321855208474239921&#45;&gt;329161111579173472 -->\n",
       "<g class=\"edge\" id=\"edge16\">\n",
       "<title>-1321855208474239921-&gt;329161111579173472</title>\n",
       "<path d=\"M243.5,-676.79C246,-686.61 248.45,-696.23 250.59,-704.61\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"247.25,-705.66 253.11,-714.49 254.03,-703.93 247.25,-705.66\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 1639906887576484224 -->\n",
       "<g class=\"node\" id=\"node18\">\n",
       "<title>1639906887576484224</title>\n",
       "<polygon fill=\"none\" points=\"253.54,-503.78 199.54,-503.78 199.54,-467.78 253.54,-467.78 253.54,-503.78\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"226.54\" y=\"-482.08\">(0, 3)</text>\n",
       "</g>\n",
       "<!-- 1639906887576484224&#45;&gt;&#45;1321855208474239921 -->\n",
       "<g class=\"edge\" id=\"edge17\">\n",
       "<title>1639906887576484224-&gt;-1321855208474239921</title>\n",
       "<path d=\"M226.54,-503.94C226.54,-511.13 226.54,-520.03 226.54,-529.59\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"223.04,-529.75 226.54,-539.75 230.04,-529.75 223.04,-529.75\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 957055651201464590 -->\n",
       "<g class=\"node\" id=\"node19\">\n",
       "<title>957055651201464590</title>\n",
       "<ellipse cx=\"69.54\" cy=\"-403.18\" fill=\"none\" rx=\"28.7\" ry=\"28.7\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"69.54\" y=\"-399.48\">mul</text>\n",
       "</g>\n",
       "<!-- 957055651201464590&#45;&gt;1639906887577649273 -->\n",
       "<g class=\"edge\" id=\"edge18\">\n",
       "<title>957055651201464590-&gt;1639906887577649273</title>\n",
       "<path d=\"M69.54,-431.92C69.54,-440.15 69.54,-449.16 69.54,-457.37\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"66.04,-457.57 69.54,-467.57 73.04,-457.57 66.04,-457.57\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 5581130617534253882 -->\n",
       "<g class=\"node\" id=\"node20\">\n",
       "<title>5581130617534253882</title>\n",
       "<polygon fill=\"none\" points=\"86.54,-136.99 32.54,-136.99 32.54,-100.99 86.54,-100.99 86.54,-136.99\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"59.54\" y=\"-115.29\">(0, 0)</text>\n",
       "</g>\n",
       "<!-- 5581130617534253882&#45;&gt;957055651201464590 -->\n",
       "<g class=\"edge\" id=\"edge19\">\n",
       "<title>5581130617534253882-&gt;957055651201464590</title>\n",
       "<path d=\"M52.06,-137.29C48.07,-147.47 43.57,-160.72 41.54,-172.99 30.34,-240.83 46.72,-320.66 58.75,-365.95\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"55.38,-366.89 61.39,-375.61 62.13,-365.04 55.38,-366.89\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 7678599310528048269 -->\n",
       "<g class=\"node\" id=\"node35\">\n",
       "<title>7678599310528048269</title>\n",
       "<ellipse cx=\"97.54\" cy=\"-219.79\" fill=\"none\" rx=\"46.59\" ry=\"46.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"97.54\" y=\"-216.09\">getitem</text>\n",
       "</g>\n",
       "<!-- 5581130617534253882&#45;&gt;7678599310528048269 -->\n",
       "<g class=\"edge\" id=\"edge35\">\n",
       "<title>5581130617534253882-&gt;7678599310528048269</title>\n",
       "<path d=\"M66.16,-137.2C69.32,-145.41 73.29,-155.73 77.33,-166.23\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"74.18,-167.8 81.04,-175.88 80.72,-165.29 74.18,-167.8\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 2239995699189520991 -->\n",
       "<g class=\"node\" id=\"node21\">\n",
       "<title>2239995699189520991</title>\n",
       "<polygon fill=\"none\" points=\"128.54,-338.59 74.54,-338.59 74.54,-302.59 128.54,-302.59 128.54,-338.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"101.54\" y=\"-316.89\">(0, 0)</text>\n",
       "</g>\n",
       "<!-- 2239995699189520991&#45;&gt;957055651201464590 -->\n",
       "<g class=\"edge\" id=\"edge20\">\n",
       "<title>2239995699189520991-&gt;957055651201464590</title>\n",
       "<path d=\"M94.76,-338.68C91.51,-346.86 87.49,-356.97 83.63,-366.7\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"80.29,-365.64 79.85,-376.22 86.79,-368.22 80.29,-365.64\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 2397661101343043365 -->\n",
       "<g class=\"node\" id=\"node22\">\n",
       "<title>2397661101343043365</title>\n",
       "<ellipse cx=\"383.54\" cy=\"-403.18\" fill=\"none\" rx=\"28.7\" ry=\"28.7\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"383.54\" y=\"-399.48\">mul</text>\n",
       "</g>\n",
       "<!-- 2397661101343043365&#45;&gt;1639906887578814322 -->\n",
       "<g class=\"edge\" id=\"edge21\">\n",
       "<title>2397661101343043365-&gt;1639906887578814322</title>\n",
       "<path d=\"M383.54,-431.92C383.54,-440.15 383.54,-449.16 383.54,-457.37\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"380.04,-457.57 383.54,-467.57 387.04,-457.57 380.04,-457.57\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 2239995699190686040 -->\n",
       "<g class=\"node\" id=\"node23\">\n",
       "<title>2239995699190686040</title>\n",
       "<polygon fill=\"none\" points=\"397.54,-338.59 343.54,-338.59 343.54,-302.59 397.54,-302.59 397.54,-338.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"370.54\" y=\"-316.89\">(0, 1)</text>\n",
       "</g>\n",
       "<!-- 2239995699190686040&#45;&gt;2397661101343043365 -->\n",
       "<g class=\"edge\" id=\"edge22\">\n",
       "<title>2239995699190686040-&gt;2397661101343043365</title>\n",
       "<path d=\"M373.3,-338.68C374.52,-346.27 376.02,-355.52 377.48,-364.59\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"374.06,-365.34 379.1,-374.65 380.97,-364.22 374.06,-365.34\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 5581130617533088833 -->\n",
       "<g class=\"node\" id=\"node24\">\n",
       "<title>5581130617533088833</title>\n",
       "<polygon fill=\"none\" points=\"543.54,-136.99 489.54,-136.99 489.54,-100.99 543.54,-100.99 543.54,-136.99\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"516.54\" y=\"-115.29\">(0, 1)</text>\n",
       "</g>\n",
       "<!-- 5581130617533088833&#45;&gt;2397661101343043365 -->\n",
       "<g class=\"edge\" id=\"edge23\">\n",
       "<title>5581130617533088833-&gt;2397661101343043365</title>\n",
       "<path d=\"M508.42,-137.22C486.96,-182.77 428.39,-307.04 399.75,-367.8\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"396.52,-366.45 395.42,-376.99 402.85,-369.44 396.52,-366.45\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 846042919822719894 -->\n",
       "<g class=\"node\" id=\"node36\">\n",
       "<title>846042919822719894</title>\n",
       "<ellipse cx=\"554.54\" cy=\"-219.79\" fill=\"none\" rx=\"46.59\" ry=\"46.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"554.54\" y=\"-216.09\">getitem</text>\n",
       "</g>\n",
       "<!-- 5581130617533088833&#45;&gt;846042919822719894 -->\n",
       "<g class=\"edge\" id=\"edge37\">\n",
       "<title>5581130617533088833-&gt;846042919822719894</title>\n",
       "<path d=\"M523.16,-137.2C526.32,-145.41 530.29,-155.73 534.33,-166.23\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"531.18,-167.8 538.04,-175.88 537.72,-165.29 531.18,-167.8\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;6610479145245979160 -->\n",
       "<g class=\"node\" id=\"node25\">\n",
       "<title>-6610479145245979160</title>\n",
       "<ellipse cx=\"540.54\" cy=\"-403.18\" fill=\"none\" rx=\"28.7\" ry=\"28.7\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"540.54\" y=\"-399.48\">mul</text>\n",
       "</g>\n",
       "<!-- &#45;6610479145245979160&#45;&gt;1639906887575319175 -->\n",
       "<g class=\"edge\" id=\"edge24\">\n",
       "<title>-6610479145245979160-&gt;1639906887575319175</title>\n",
       "<path d=\"M540.54,-431.92C540.54,-440.15 540.54,-449.16 540.54,-457.37\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"537.04,-457.57 540.54,-467.57 544.04,-457.57 537.04,-457.57\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 5581130617531923784 -->\n",
       "<g class=\"node\" id=\"node26\">\n",
       "<title>5581130617531923784</title>\n",
       "<polygon fill=\"none\" points=\"408.54,-136.99 354.54,-136.99 354.54,-100.99 408.54,-100.99 408.54,-136.99\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"381.54\" y=\"-115.29\">(0, 2)</text>\n",
       "</g>\n",
       "<!-- 5581130617531923784&#45;&gt;&#45;6610479145245979160 -->\n",
       "<g class=\"edge\" id=\"edge25\">\n",
       "<title>5581130617531923784-&gt;-6610479145245979160</title>\n",
       "<path d=\"M396.05,-137.07C404.3,-147.18 414.55,-160.43 422.54,-172.99 444.88,-208.07 496.97,-313 523.85,-367.88\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"520.87,-369.75 528.4,-377.2 527.15,-366.68 520.87,-369.75\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 4209223212487584919 -->\n",
       "<g class=\"node\" id=\"node37\">\n",
       "<title>4209223212487584919</title>\n",
       "<ellipse cx=\"366.54\" cy=\"-219.79\" fill=\"none\" rx=\"46.59\" ry=\"46.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"366.54\" y=\"-216.09\">getitem</text>\n",
       "</g>\n",
       "<!-- 5581130617531923784&#45;&gt;4209223212487584919 -->\n",
       "<g class=\"edge\" id=\"edge39\">\n",
       "<title>5581130617531923784-&gt;4209223212487584919</title>\n",
       "<path d=\"M378.93,-137.2C377.8,-144.67 376.4,-153.88 374.96,-163.38\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"371.49,-162.93 373.44,-173.34 378.41,-163.98 371.49,-162.93\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 2239995699191851089 -->\n",
       "<g class=\"node\" id=\"node27\">\n",
       "<title>2239995699191851089</title>\n",
       "<polygon fill=\"none\" points=\"572.54,-338.59 518.54,-338.59 518.54,-302.59 572.54,-302.59 572.54,-338.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"545.54\" y=\"-316.89\">(0, 2)</text>\n",
       "</g>\n",
       "<!-- 2239995699191851089&#45;&gt;&#45;6610479145245979160 -->\n",
       "<g class=\"edge\" id=\"edge26\">\n",
       "<title>2239995699191851089-&gt;-6610479145245979160</title>\n",
       "<path d=\"M544.48,-338.68C544.02,-346.2 543.45,-355.36 542.89,-364.35\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"539.4,-364.14 542.27,-374.33 546.38,-364.57 539.4,-364.14\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;4679051174042245585 -->\n",
       "<g class=\"node\" id=\"node28\">\n",
       "<title>-4679051174042245585</title>\n",
       "<ellipse cx=\"226.54\" cy=\"-403.18\" fill=\"none\" rx=\"28.7\" ry=\"28.7\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"226.54\" y=\"-399.48\">mul</text>\n",
       "</g>\n",
       "<!-- &#45;4679051174042245585&#45;&gt;1639906887576484224 -->\n",
       "<g class=\"edge\" id=\"edge27\">\n",
       "<title>-4679051174042245585-&gt;1639906887576484224</title>\n",
       "<path d=\"M226.54,-431.92C226.54,-440.15 226.54,-449.16 226.54,-457.37\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"223.04,-457.57 226.54,-467.57 230.04,-457.57 223.04,-457.57\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 2239995699193016138 -->\n",
       "<g class=\"node\" id=\"node29\">\n",
       "<title>2239995699193016138</title>\n",
       "<polygon fill=\"none\" points=\"233.54,-338.59 179.54,-338.59 179.54,-302.59 233.54,-302.59 233.54,-338.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"206.54\" y=\"-316.89\">(0, 3)</text>\n",
       "</g>\n",
       "<!-- 2239995699193016138&#45;&gt;&#45;4679051174042245585 -->\n",
       "<g class=\"edge\" id=\"edge28\">\n",
       "<title>2239995699193016138-&gt;-4679051174042245585</title>\n",
       "<path d=\"M210.79,-338.68C212.72,-346.48 215.1,-356.05 217.41,-365.37\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"214.06,-366.42 219.87,-375.28 220.86,-364.73 214.06,-366.42\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 5581130617530758735 -->\n",
       "<g class=\"node\" id=\"node30\">\n",
       "<title>5581130617530758735</title>\n",
       "<polygon fill=\"none\" points=\"273.54,-136.99 219.54,-136.99 219.54,-100.99 273.54,-100.99 273.54,-136.99\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"246.54\" y=\"-115.29\">(0, 3)</text>\n",
       "</g>\n",
       "<!-- 5581130617530758735&#45;&gt;&#45;4679051174042245585 -->\n",
       "<g class=\"edge\" id=\"edge29\">\n",
       "<title>5581130617530758735-&gt;-4679051174042245585</title>\n",
       "<path d=\"M254.44,-137.25C258.65,-147.42 263.4,-160.67 265.54,-172.99 272.67,-213.98 271.35,-225.4 265.54,-266.59 260.66,-301.21 249.1,-339.39 239.82,-366.39\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"236.4,-365.56 236.4,-376.16 243.01,-367.88 236.4,-365.56\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 4639263246309438544 -->\n",
       "<g class=\"node\" id=\"node38\">\n",
       "<title>4639263246309438544</title>\n",
       "<ellipse cx=\"209.54\" cy=\"-219.79\" fill=\"none\" rx=\"46.59\" ry=\"46.59\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"209.54\" y=\"-216.09\">getitem</text>\n",
       "</g>\n",
       "<!-- 5581130617530758735&#45;&gt;4639263246309438544 -->\n",
       "<g class=\"edge\" id=\"edge41\">\n",
       "<title>5581130617530758735-&gt;4639263246309438544</title>\n",
       "<path d=\"M240.1,-137.2C237.06,-145.33 233.24,-155.52 229.35,-165.91\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"226,-164.86 225.77,-175.46 232.56,-167.32 226,-164.86\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;1467910790690776579 -->\n",
       "<g class=\"node\" id=\"node31\">\n",
       "<title>-1467910790690776579</title>\n",
       "<ellipse cx=\"59.54\" cy=\"-32.5\" fill=\"none\" rx=\"32.49\" ry=\"32.49\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"59.54\" y=\"-28.8\">ones</text>\n",
       "</g>\n",
       "<!-- &#45;1467910790690776579&#45;&gt;5581130617534253882 -->\n",
       "<g class=\"edge\" id=\"edge30\">\n",
       "<title>-1467910790690776579-&gt;5581130617534253882</title>\n",
       "<path d=\"M59.54,-65.44C59.54,-73.67 59.54,-82.45 59.54,-90.43\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"56.04,-90.69 59.54,-100.69 63.04,-90.69 56.04,-90.69\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;1090831373445564154 -->\n",
       "<g class=\"node\" id=\"node32\">\n",
       "<title>-1090831373445564154</title>\n",
       "<ellipse cx=\"516.54\" cy=\"-32.5\" fill=\"none\" rx=\"32.49\" ry=\"32.49\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"516.54\" y=\"-28.8\">ones</text>\n",
       "</g>\n",
       "<!-- &#45;1090831373445564154&#45;&gt;5581130617533088833 -->\n",
       "<g class=\"edge\" id=\"edge31\">\n",
       "<title>-1090831373445564154-&gt;5581130617533088833</title>\n",
       "<path d=\"M516.54,-65.44C516.54,-73.67 516.54,-82.45 516.54,-90.43\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"513.04,-90.69 516.54,-100.69 520.04,-90.69 513.04,-90.69\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 1062196149202694471 -->\n",
       "<g class=\"node\" id=\"node33\">\n",
       "<title>1062196149202694471</title>\n",
       "<ellipse cx=\"381.54\" cy=\"-32.5\" fill=\"none\" rx=\"32.49\" ry=\"32.49\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"381.54\" y=\"-28.8\">ones</text>\n",
       "</g>\n",
       "<!-- 1062196149202694471&#45;&gt;5581130617531923784 -->\n",
       "<g class=\"edge\" id=\"edge32\">\n",
       "<title>1062196149202694471-&gt;5581130617531923784</title>\n",
       "<path d=\"M381.54,-65.44C381.54,-73.67 381.54,-82.45 381.54,-90.43\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"378.04,-90.69 381.54,-100.69 385.04,-90.69 378.04,-90.69\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;5179843938900528704 -->\n",
       "<g class=\"node\" id=\"node34\">\n",
       "<title>-5179843938900528704</title>\n",
       "<ellipse cx=\"246.54\" cy=\"-32.5\" fill=\"none\" rx=\"32.49\" ry=\"32.49\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"246.54\" y=\"-28.8\">ones</text>\n",
       "</g>\n",
       "<!-- &#45;5179843938900528704&#45;&gt;5581130617530758735 -->\n",
       "<g class=\"edge\" id=\"edge33\">\n",
       "<title>-5179843938900528704-&gt;5581130617530758735</title>\n",
       "<path d=\"M246.54,-65.44C246.54,-73.67 246.54,-82.45 246.54,-90.43\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"243.04,-90.69 246.54,-100.69 250.04,-90.69 243.04,-90.69\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 7678599310528048269&#45;&gt;2239995699193016138 -->\n",
       "<g class=\"edge\" id=\"edge34\">\n",
       "<title>7678599310528048269-&gt;2239995699193016138</title>\n",
       "<path d=\"M131.73,-251.78C147.33,-265.91 165.51,-282.39 180.04,-295.56\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"177.94,-298.38 187.7,-302.51 182.64,-293.2 177.94,-298.38\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 846042919822719894&#45;&gt;2239995699191851089 -->\n",
       "<g class=\"edge\" id=\"edge36\">\n",
       "<title>846042919822719894-&gt;2239995699191851089</title>\n",
       "<path d=\"M550.39,-266.43C549.59,-275.19 548.78,-284.11 548.05,-292.07\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"544.55,-291.96 547.12,-302.24 551.52,-292.6 544.55,-291.96\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 4209223212487584919&#45;&gt;2239995699190686040 -->\n",
       "<g class=\"edge\" id=\"edge38\">\n",
       "<title>4209223212487584919-&gt;2239995699190686040</title>\n",
       "<path d=\"M368.4,-266.72C368.76,-275.45 369.12,-284.32 369.44,-292.25\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"365.94,-292.51 369.85,-302.36 372.94,-292.22 365.94,-292.51\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 4639263246309438544&#45;&gt;2239995699189520991 -->\n",
       "<g class=\"edge\" id=\"edge40\">\n",
       "<title>4639263246309438544-&gt;2239995699189520991</title>\n",
       "<path d=\"M175.37,-252.05C160.04,-266.07 142.24,-282.36 127.95,-295.43\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"125.43,-292.99 120.42,-302.32 130.16,-298.15 125.43,-292.99\" stroke=\"black\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>"
      ],
      "text/plain": [
       "<IPython.core.display.SVG object>"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "fancy_calculation = (ones * ones[::-1, ::-1]).mean()\n",
    "fancy_calculation.visualize(format='svg')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### A Bigger Calculation\n",
    "\n",
    "The examples above were toy examples; the data (32 MB) is nowhere nearly big enough to warrant the use of dask.\n",
    "\n",
    "We can make it a lot bigger!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<tr>\n",
       "<td>\n",
       "<table>\n",
       "  <thead>\n",
       "    <tr><td> </td><th> Array </th><th> Chunk </th></tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr><th> Bytes </th><td> 6.40 GB </td> <td> 8.00 MB </td></tr>\n",
       "    <tr><th> Shape </th><td> (200000, 4000) </td> <td> (1000, 1000) </td></tr>\n",
       "    <tr><th> Count </th><td> 800 Tasks </td><td> 800 Chunks </td></tr>\n",
       "    <tr><th> Type </th><td> float64 </td><td> numpy.ndarray </td></tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</td>\n",
       "<td>\n",
       "<svg width=\"79\" height=\"170\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"29\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"29\" y2=\"0\" />\n",
       "  <line x1=\"0\" y1=\"1\" x2=\"29\" y2=\"1\" />\n",
       "  <line x1=\"0\" y1=\"1\" x2=\"29\" y2=\"1\" />\n",
       "  <line x1=\"0\" y1=\"2\" x2=\"29\" y2=\"2\" />\n",
       "  <line x1=\"0\" y1=\"3\" x2=\"29\" y2=\"3\" />\n",
       "  <line x1=\"0\" y1=\"3\" x2=\"29\" y2=\"3\" />\n",
       "  <line x1=\"0\" y1=\"4\" x2=\"29\" y2=\"4\" />\n",
       "  <line x1=\"0\" y1=\"4\" x2=\"29\" y2=\"4\" />\n",
       "  <line x1=\"0\" y1=\"5\" x2=\"29\" y2=\"5\" />\n",
       "  <line x1=\"0\" y1=\"6\" x2=\"29\" y2=\"6\" />\n",
       "  <line x1=\"0\" y1=\"6\" x2=\"29\" y2=\"6\" />\n",
       "  <line x1=\"0\" y1=\"7\" x2=\"29\" y2=\"7\" />\n",
       "  <line x1=\"0\" y1=\"7\" x2=\"29\" y2=\"7\" />\n",
       "  <line x1=\"0\" y1=\"8\" x2=\"29\" y2=\"8\" />\n",
       "  <line x1=\"0\" y1=\"9\" x2=\"29\" y2=\"9\" />\n",
       "  <line x1=\"0\" y1=\"9\" x2=\"29\" y2=\"9\" />\n",
       "  <line x1=\"0\" y1=\"10\" x2=\"29\" y2=\"10\" />\n",
       "  <line x1=\"0\" y1=\"10\" x2=\"29\" y2=\"10\" />\n",
       "  <line x1=\"0\" y1=\"11\" x2=\"29\" y2=\"11\" />\n",
       "  <line x1=\"0\" y1=\"12\" x2=\"29\" y2=\"12\" />\n",
       "  <line x1=\"0\" y1=\"12\" x2=\"29\" y2=\"12\" />\n",
       "  <line x1=\"0\" y1=\"13\" x2=\"29\" y2=\"13\" />\n",
       "  <line x1=\"0\" y1=\"13\" x2=\"29\" y2=\"13\" />\n",
       "  <line x1=\"0\" y1=\"14\" x2=\"29\" y2=\"14\" />\n",
       "  <line x1=\"0\" y1=\"15\" x2=\"29\" y2=\"15\" />\n",
       "  <line x1=\"0\" y1=\"15\" x2=\"29\" y2=\"15\" />\n",
       "  <line x1=\"0\" y1=\"16\" x2=\"29\" y2=\"16\" />\n",
       "  <line x1=\"0\" y1=\"16\" x2=\"29\" y2=\"16\" />\n",
       "  <line x1=\"0\" y1=\"17\" x2=\"29\" y2=\"17\" />\n",
       "  <line x1=\"0\" y1=\"18\" x2=\"29\" y2=\"18\" />\n",
       "  <line x1=\"0\" y1=\"18\" x2=\"29\" y2=\"18\" />\n",
       "  <line x1=\"0\" y1=\"19\" x2=\"29\" y2=\"19\" />\n",
       "  <line x1=\"0\" y1=\"19\" x2=\"29\" y2=\"19\" />\n",
       "  <line x1=\"0\" y1=\"20\" x2=\"29\" y2=\"20\" />\n",
       "  <line x1=\"0\" y1=\"21\" x2=\"29\" y2=\"21\" />\n",
       "  <line x1=\"0\" y1=\"21\" x2=\"29\" y2=\"21\" />\n",
       "  <line x1=\"0\" y1=\"22\" x2=\"29\" y2=\"22\" />\n",
       "  <line x1=\"0\" y1=\"22\" x2=\"29\" y2=\"22\" />\n",
       "  <line x1=\"0\" y1=\"23\" x2=\"29\" y2=\"23\" />\n",
       "  <line x1=\"0\" y1=\"24\" x2=\"29\" y2=\"24\" />\n",
       "  <line x1=\"0\" y1=\"24\" x2=\"29\" y2=\"24\" />\n",
       "  <line x1=\"0\" y1=\"25\" x2=\"29\" y2=\"25\" />\n",
       "  <line x1=\"0\" y1=\"25\" x2=\"29\" y2=\"25\" />\n",
       "  <line x1=\"0\" y1=\"26\" x2=\"29\" y2=\"26\" />\n",
       "  <line x1=\"0\" y1=\"27\" x2=\"29\" y2=\"27\" />\n",
       "  <line x1=\"0\" y1=\"27\" x2=\"29\" y2=\"27\" />\n",
       "  <line x1=\"0\" y1=\"28\" x2=\"29\" y2=\"28\" />\n",
       "  <line x1=\"0\" y1=\"28\" x2=\"29\" y2=\"28\" />\n",
       "  <line x1=\"0\" y1=\"29\" x2=\"29\" y2=\"29\" />\n",
       "  <line x1=\"0\" y1=\"30\" x2=\"29\" y2=\"30\" />\n",
       "  <line x1=\"0\" y1=\"30\" x2=\"29\" y2=\"30\" />\n",
       "  <line x1=\"0\" y1=\"31\" x2=\"29\" y2=\"31\" />\n",
       "  <line x1=\"0\" y1=\"31\" x2=\"29\" y2=\"31\" />\n",
       "  <line x1=\"0\" y1=\"32\" x2=\"29\" y2=\"32\" />\n",
       "  <line x1=\"0\" y1=\"33\" x2=\"29\" y2=\"33\" />\n",
       "  <line x1=\"0\" y1=\"33\" x2=\"29\" y2=\"33\" />\n",
       "  <line x1=\"0\" y1=\"34\" x2=\"29\" y2=\"34\" />\n",
       "  <line x1=\"0\" y1=\"34\" x2=\"29\" y2=\"34\" />\n",
       "  <line x1=\"0\" y1=\"35\" x2=\"29\" y2=\"35\" />\n",
       "  <line x1=\"0\" y1=\"36\" x2=\"29\" y2=\"36\" />\n",
       "  <line x1=\"0\" y1=\"36\" x2=\"29\" y2=\"36\" />\n",
       "  <line x1=\"0\" y1=\"37\" x2=\"29\" y2=\"37\" />\n",
       "  <line x1=\"0\" y1=\"37\" x2=\"29\" y2=\"37\" />\n",
       "  <line x1=\"0\" y1=\"38\" x2=\"29\" y2=\"38\" />\n",
       "  <line x1=\"0\" y1=\"39\" x2=\"29\" y2=\"39\" />\n",
       "  <line x1=\"0\" y1=\"39\" x2=\"29\" y2=\"39\" />\n",
       "  <line x1=\"0\" y1=\"40\" x2=\"29\" y2=\"40\" />\n",
       "  <line x1=\"0\" y1=\"40\" x2=\"29\" y2=\"40\" />\n",
       "  <line x1=\"0\" y1=\"41\" x2=\"29\" y2=\"41\" />\n",
       "  <line x1=\"0\" y1=\"42\" x2=\"29\" y2=\"42\" />\n",
       "  <line x1=\"0\" y1=\"42\" x2=\"29\" y2=\"42\" />\n",
       "  <line x1=\"0\" y1=\"43\" x2=\"29\" y2=\"43\" />\n",
       "  <line x1=\"0\" y1=\"43\" x2=\"29\" y2=\"43\" />\n",
       "  <line x1=\"0\" y1=\"44\" x2=\"29\" y2=\"44\" />\n",
       "  <line x1=\"0\" y1=\"45\" x2=\"29\" y2=\"45\" />\n",
       "  <line x1=\"0\" y1=\"45\" x2=\"29\" y2=\"45\" />\n",
       "  <line x1=\"0\" y1=\"46\" x2=\"29\" y2=\"46\" />\n",
       "  <line x1=\"0\" y1=\"46\" x2=\"29\" y2=\"46\" />\n",
       "  <line x1=\"0\" y1=\"47\" x2=\"29\" y2=\"47\" />\n",
       "  <line x1=\"0\" y1=\"48\" x2=\"29\" y2=\"48\" />\n",
       "  <line x1=\"0\" y1=\"48\" x2=\"29\" y2=\"48\" />\n",
       "  <line x1=\"0\" y1=\"49\" x2=\"29\" y2=\"49\" />\n",
       "  <line x1=\"0\" y1=\"49\" x2=\"29\" y2=\"49\" />\n",
       "  <line x1=\"0\" y1=\"50\" x2=\"29\" y2=\"50\" />\n",
       "  <line x1=\"0\" y1=\"51\" x2=\"29\" y2=\"51\" />\n",
       "  <line x1=\"0\" y1=\"51\" x2=\"29\" y2=\"51\" />\n",
       "  <line x1=\"0\" y1=\"52\" x2=\"29\" y2=\"52\" />\n",
       "  <line x1=\"0\" y1=\"52\" x2=\"29\" y2=\"52\" />\n",
       "  <line x1=\"0\" y1=\"53\" x2=\"29\" y2=\"53\" />\n",
       "  <line x1=\"0\" y1=\"54\" x2=\"29\" y2=\"54\" />\n",
       "  <line x1=\"0\" y1=\"54\" x2=\"29\" y2=\"54\" />\n",
       "  <line x1=\"0\" y1=\"55\" x2=\"29\" y2=\"55\" />\n",
       "  <line x1=\"0\" y1=\"55\" x2=\"29\" y2=\"55\" />\n",
       "  <line x1=\"0\" y1=\"56\" x2=\"29\" y2=\"56\" />\n",
       "  <line x1=\"0\" y1=\"57\" x2=\"29\" y2=\"57\" />\n",
       "  <line x1=\"0\" y1=\"57\" x2=\"29\" y2=\"57\" />\n",
       "  <line x1=\"0\" y1=\"58\" x2=\"29\" y2=\"58\" />\n",
       "  <line x1=\"0\" y1=\"58\" x2=\"29\" y2=\"58\" />\n",
       "  <line x1=\"0\" y1=\"59\" x2=\"29\" y2=\"59\" />\n",
       "  <line x1=\"0\" y1=\"60\" x2=\"29\" y2=\"60\" />\n",
       "  <line x1=\"0\" y1=\"60\" x2=\"29\" y2=\"60\" />\n",
       "  <line x1=\"0\" y1=\"61\" x2=\"29\" y2=\"61\" />\n",
       "  <line x1=\"0\" y1=\"61\" x2=\"29\" y2=\"61\" />\n",
       "  <line x1=\"0\" y1=\"62\" x2=\"29\" y2=\"62\" />\n",
       "  <line x1=\"0\" y1=\"63\" x2=\"29\" y2=\"63\" />\n",
       "  <line x1=\"0\" y1=\"63\" x2=\"29\" y2=\"63\" />\n",
       "  <line x1=\"0\" y1=\"64\" x2=\"29\" y2=\"64\" />\n",
       "  <line x1=\"0\" y1=\"64\" x2=\"29\" y2=\"64\" />\n",
       "  <line x1=\"0\" y1=\"65\" x2=\"29\" y2=\"65\" />\n",
       "  <line x1=\"0\" y1=\"66\" x2=\"29\" y2=\"66\" />\n",
       "  <line x1=\"0\" y1=\"66\" x2=\"29\" y2=\"66\" />\n",
       "  <line x1=\"0\" y1=\"67\" x2=\"29\" y2=\"67\" />\n",
       "  <line x1=\"0\" y1=\"67\" x2=\"29\" y2=\"67\" />\n",
       "  <line x1=\"0\" y1=\"68\" x2=\"29\" y2=\"68\" />\n",
       "  <line x1=\"0\" y1=\"69\" x2=\"29\" y2=\"69\" />\n",
       "  <line x1=\"0\" y1=\"69\" x2=\"29\" y2=\"69\" />\n",
       "  <line x1=\"0\" y1=\"70\" x2=\"29\" y2=\"70\" />\n",
       "  <line x1=\"0\" y1=\"70\" x2=\"29\" y2=\"70\" />\n",
       "  <line x1=\"0\" y1=\"71\" x2=\"29\" y2=\"71\" />\n",
       "  <line x1=\"0\" y1=\"72\" x2=\"29\" y2=\"72\" />\n",
       "  <line x1=\"0\" y1=\"72\" x2=\"29\" y2=\"72\" />\n",
       "  <line x1=\"0\" y1=\"73\" x2=\"29\" y2=\"73\" />\n",
       "  <line x1=\"0\" y1=\"73\" x2=\"29\" y2=\"73\" />\n",
       "  <line x1=\"0\" y1=\"74\" x2=\"29\" y2=\"74\" />\n",
       "  <line x1=\"0\" y1=\"75\" x2=\"29\" y2=\"75\" />\n",
       "  <line x1=\"0\" y1=\"75\" x2=\"29\" y2=\"75\" />\n",
       "  <line x1=\"0\" y1=\"76\" x2=\"29\" y2=\"76\" />\n",
       "  <line x1=\"0\" y1=\"76\" x2=\"29\" y2=\"76\" />\n",
       "  <line x1=\"0\" y1=\"77\" x2=\"29\" y2=\"77\" />\n",
       "  <line x1=\"0\" y1=\"78\" x2=\"29\" y2=\"78\" />\n",
       "  <line x1=\"0\" y1=\"78\" x2=\"29\" y2=\"78\" />\n",
       "  <line x1=\"0\" y1=\"79\" x2=\"29\" y2=\"79\" />\n",
       "  <line x1=\"0\" y1=\"79\" x2=\"29\" y2=\"79\" />\n",
       "  <line x1=\"0\" y1=\"80\" x2=\"29\" y2=\"80\" />\n",
       "  <line x1=\"0\" y1=\"81\" x2=\"29\" y2=\"81\" />\n",
       "  <line x1=\"0\" y1=\"81\" x2=\"29\" y2=\"81\" />\n",
       "  <line x1=\"0\" y1=\"82\" x2=\"29\" y2=\"82\" />\n",
       "  <line x1=\"0\" y1=\"82\" x2=\"29\" y2=\"82\" />\n",
       "  <line x1=\"0\" y1=\"83\" x2=\"29\" y2=\"83\" />\n",
       "  <line x1=\"0\" y1=\"84\" x2=\"29\" y2=\"84\" />\n",
       "  <line x1=\"0\" y1=\"84\" x2=\"29\" y2=\"84\" />\n",
       "  <line x1=\"0\" y1=\"85\" x2=\"29\" y2=\"85\" />\n",
       "  <line x1=\"0\" y1=\"85\" x2=\"29\" y2=\"85\" />\n",
       "  <line x1=\"0\" y1=\"86\" x2=\"29\" y2=\"86\" />\n",
       "  <line x1=\"0\" y1=\"87\" x2=\"29\" y2=\"87\" />\n",
       "  <line x1=\"0\" y1=\"87\" x2=\"29\" y2=\"87\" />\n",
       "  <line x1=\"0\" y1=\"88\" x2=\"29\" y2=\"88\" />\n",
       "  <line x1=\"0\" y1=\"88\" x2=\"29\" y2=\"88\" />\n",
       "  <line x1=\"0\" y1=\"89\" x2=\"29\" y2=\"89\" />\n",
       "  <line x1=\"0\" y1=\"90\" x2=\"29\" y2=\"90\" />\n",
       "  <line x1=\"0\" y1=\"90\" x2=\"29\" y2=\"90\" />\n",
       "  <line x1=\"0\" y1=\"91\" x2=\"29\" y2=\"91\" />\n",
       "  <line x1=\"0\" y1=\"91\" x2=\"29\" y2=\"91\" />\n",
       "  <line x1=\"0\" y1=\"92\" x2=\"29\" y2=\"92\" />\n",
       "  <line x1=\"0\" y1=\"93\" x2=\"29\" y2=\"93\" />\n",
       "  <line x1=\"0\" y1=\"93\" x2=\"29\" y2=\"93\" />\n",
       "  <line x1=\"0\" y1=\"94\" x2=\"29\" y2=\"94\" />\n",
       "  <line x1=\"0\" y1=\"94\" x2=\"29\" y2=\"94\" />\n",
       "  <line x1=\"0\" y1=\"95\" x2=\"29\" y2=\"95\" />\n",
       "  <line x1=\"0\" y1=\"96\" x2=\"29\" y2=\"96\" />\n",
       "  <line x1=\"0\" y1=\"96\" x2=\"29\" y2=\"96\" />\n",
       "  <line x1=\"0\" y1=\"97\" x2=\"29\" y2=\"97\" />\n",
       "  <line x1=\"0\" y1=\"97\" x2=\"29\" y2=\"97\" />\n",
       "  <line x1=\"0\" y1=\"98\" x2=\"29\" y2=\"98\" />\n",
       "  <line x1=\"0\" y1=\"99\" x2=\"29\" y2=\"99\" />\n",
       "  <line x1=\"0\" y1=\"99\" x2=\"29\" y2=\"99\" />\n",
       "  <line x1=\"0\" y1=\"100\" x2=\"29\" y2=\"100\" />\n",
       "  <line x1=\"0\" y1=\"100\" x2=\"29\" y2=\"100\" />\n",
       "  <line x1=\"0\" y1=\"101\" x2=\"29\" y2=\"101\" />\n",
       "  <line x1=\"0\" y1=\"102\" x2=\"29\" y2=\"102\" />\n",
       "  <line x1=\"0\" y1=\"102\" x2=\"29\" y2=\"102\" />\n",
       "  <line x1=\"0\" y1=\"103\" x2=\"29\" y2=\"103\" />\n",
       "  <line x1=\"0\" y1=\"103\" x2=\"29\" y2=\"103\" />\n",
       "  <line x1=\"0\" y1=\"104\" x2=\"29\" y2=\"104\" />\n",
       "  <line x1=\"0\" y1=\"105\" x2=\"29\" y2=\"105\" />\n",
       "  <line x1=\"0\" y1=\"105\" x2=\"29\" y2=\"105\" />\n",
       "  <line x1=\"0\" y1=\"106\" x2=\"29\" y2=\"106\" />\n",
       "  <line x1=\"0\" y1=\"106\" x2=\"29\" y2=\"106\" />\n",
       "  <line x1=\"0\" y1=\"107\" x2=\"29\" y2=\"107\" />\n",
       "  <line x1=\"0\" y1=\"108\" x2=\"29\" y2=\"108\" />\n",
       "  <line x1=\"0\" y1=\"108\" x2=\"29\" y2=\"108\" />\n",
       "  <line x1=\"0\" y1=\"109\" x2=\"29\" y2=\"109\" />\n",
       "  <line x1=\"0\" y1=\"109\" x2=\"29\" y2=\"109\" />\n",
       "  <line x1=\"0\" y1=\"110\" x2=\"29\" y2=\"110\" />\n",
       "  <line x1=\"0\" y1=\"111\" x2=\"29\" y2=\"111\" />\n",
       "  <line x1=\"0\" y1=\"111\" x2=\"29\" y2=\"111\" />\n",
       "  <line x1=\"0\" y1=\"112\" x2=\"29\" y2=\"112\" />\n",
       "  <line x1=\"0\" y1=\"112\" x2=\"29\" y2=\"112\" />\n",
       "  <line x1=\"0\" y1=\"113\" x2=\"29\" y2=\"113\" />\n",
       "  <line x1=\"0\" y1=\"114\" x2=\"29\" y2=\"114\" />\n",
       "  <line x1=\"0\" y1=\"114\" x2=\"29\" y2=\"114\" />\n",
       "  <line x1=\"0\" y1=\"115\" x2=\"29\" y2=\"115\" />\n",
       "  <line x1=\"0\" y1=\"115\" x2=\"29\" y2=\"115\" />\n",
       "  <line x1=\"0\" y1=\"116\" x2=\"29\" y2=\"116\" />\n",
       "  <line x1=\"0\" y1=\"117\" x2=\"29\" y2=\"117\" />\n",
       "  <line x1=\"0\" y1=\"117\" x2=\"29\" y2=\"117\" />\n",
       "  <line x1=\"0\" y1=\"118\" x2=\"29\" y2=\"118\" />\n",
       "  <line x1=\"0\" y1=\"118\" x2=\"29\" y2=\"118\" />\n",
       "  <line x1=\"0\" y1=\"119\" x2=\"29\" y2=\"119\" />\n",
       "  <line x1=\"0\" y1=\"120\" x2=\"29\" y2=\"120\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"120\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"7\" y1=\"0\" x2=\"7\" y2=\"120\" />\n",
       "  <line x1=\"14\" y1=\"0\" x2=\"14\" y2=\"120\" />\n",
       "  <line x1=\"21\" y1=\"0\" x2=\"21\" y2=\"120\" />\n",
       "  <line x1=\"29\" y1=\"0\" x2=\"29\" y2=\"120\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"0.000000,0.000000 29.030629,0.000000 29.030629,120.000000 0.000000,120.000000\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"14.515315\" y=\"140.000000\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >4000</text>\n",
       "  <text x=\"49.030629\" y=\"60.000000\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,49.030629,60.000000)\">200000</text>\n",
       "</svg>\n",
       "</td>\n",
       "</tr>\n",
       "</table>"
      ],
      "text/plain": [
       "dask.array<ones, shape=(200000, 4000), dtype=float64, chunksize=(1000, 1000), chunktype=numpy.ndarray>"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bigshape = (200000, 4000)\n",
    "big_ones = da.ones(bigshape, chunks=chunk_shape)\n",
    "big_ones"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "6400.0 MB\n"
     ]
    }
   ],
   "source": [
    "print('%.1f MB' % (big_ones.nbytes / 1e6))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This dataset is 6.4 GB, rather than 32 MB! This is probably close to or greater than the amount of available RAM than you have in your computer. Nevertheless, dask has no problem working on it.\n",
    "\n",
    "_Do not try to `.visualize()` this array!_\n",
    "\n",
    "When doing a big calculation, dask also has some tools to help us understand what is happening under the hood. Let's watch the dashboard again as we do a bigger computation."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1.0"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "big_calc = (big_ones * big_ones[::-1, ::-1]).mean()\n",
    "\n",
    "result = big_calc.compute()\n",
    "result"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Reduction \n",
    "\n",
    "All the usual numpy methods work on dask arrays.\n",
    "You can also apply numpy function directly to a dask array, and it will stay lazy."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table>\n",
       "<tr>\n",
       "<td>\n",
       "<table>\n",
       "  <thead>\n",
       "    <tr><td> </td><th> Array </th><th> Chunk </th></tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr><th> Bytes </th><td> 1.60 MB </td> <td> 8.00 kB </td></tr>\n",
       "    <tr><th> Shape </th><td> (200000,) </td> <td> (1000,) </td></tr>\n",
       "    <tr><th> Count </th><td> 3400 Tasks </td><td> 200 Chunks </td></tr>\n",
       "    <tr><th> Type </th><td> float64 </td><td> numpy.ndarray </td></tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</td>\n",
       "<td>\n",
       "<svg width=\"170\" height=\"75\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"120\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"0\" y1=\"25\" x2=\"120\" y2=\"25\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"25\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"25\" />\n",
       "  <line x1=\"1\" y1=\"0\" x2=\"1\" y2=\"25\" />\n",
       "  <line x1=\"1\" y1=\"0\" x2=\"1\" y2=\"25\" />\n",
       "  <line x1=\"2\" y1=\"0\" x2=\"2\" y2=\"25\" />\n",
       "  <line x1=\"3\" y1=\"0\" x2=\"3\" y2=\"25\" />\n",
       "  <line x1=\"3\" y1=\"0\" x2=\"3\" y2=\"25\" />\n",
       "  <line x1=\"4\" y1=\"0\" x2=\"4\" y2=\"25\" />\n",
       "  <line x1=\"4\" y1=\"0\" x2=\"4\" y2=\"25\" />\n",
       "  <line x1=\"5\" y1=\"0\" x2=\"5\" y2=\"25\" />\n",
       "  <line x1=\"6\" y1=\"0\" x2=\"6\" y2=\"25\" />\n",
       "  <line x1=\"6\" y1=\"0\" x2=\"6\" y2=\"25\" />\n",
       "  <line x1=\"7\" y1=\"0\" x2=\"7\" y2=\"25\" />\n",
       "  <line x1=\"7\" y1=\"0\" x2=\"7\" y2=\"25\" />\n",
       "  <line x1=\"8\" y1=\"0\" x2=\"8\" y2=\"25\" />\n",
       "  <line x1=\"9\" y1=\"0\" x2=\"9\" y2=\"25\" />\n",
       "  <line x1=\"9\" y1=\"0\" x2=\"9\" y2=\"25\" />\n",
       "  <line x1=\"10\" y1=\"0\" x2=\"10\" y2=\"25\" />\n",
       "  <line x1=\"10\" y1=\"0\" x2=\"10\" y2=\"25\" />\n",
       "  <line x1=\"11\" y1=\"0\" x2=\"11\" y2=\"25\" />\n",
       "  <line x1=\"12\" y1=\"0\" x2=\"12\" y2=\"25\" />\n",
       "  <line x1=\"12\" y1=\"0\" x2=\"12\" y2=\"25\" />\n",
       "  <line x1=\"13\" y1=\"0\" x2=\"13\" y2=\"25\" />\n",
       "  <line x1=\"13\" y1=\"0\" x2=\"13\" y2=\"25\" />\n",
       "  <line x1=\"14\" y1=\"0\" x2=\"14\" y2=\"25\" />\n",
       "  <line x1=\"15\" y1=\"0\" x2=\"15\" y2=\"25\" />\n",
       "  <line x1=\"15\" y1=\"0\" x2=\"15\" y2=\"25\" />\n",
       "  <line x1=\"16\" y1=\"0\" x2=\"16\" y2=\"25\" />\n",
       "  <line x1=\"16\" y1=\"0\" x2=\"16\" y2=\"25\" />\n",
       "  <line x1=\"17\" y1=\"0\" x2=\"17\" y2=\"25\" />\n",
       "  <line x1=\"18\" y1=\"0\" x2=\"18\" y2=\"25\" />\n",
       "  <line x1=\"18\" y1=\"0\" x2=\"18\" y2=\"25\" />\n",
       "  <line x1=\"19\" y1=\"0\" x2=\"19\" y2=\"25\" />\n",
       "  <line x1=\"19\" y1=\"0\" x2=\"19\" y2=\"25\" />\n",
       "  <line x1=\"20\" y1=\"0\" x2=\"20\" y2=\"25\" />\n",
       "  <line x1=\"21\" y1=\"0\" x2=\"21\" y2=\"25\" />\n",
       "  <line x1=\"21\" y1=\"0\" x2=\"21\" y2=\"25\" />\n",
       "  <line x1=\"22\" y1=\"0\" x2=\"22\" y2=\"25\" />\n",
       "  <line x1=\"22\" y1=\"0\" x2=\"22\" y2=\"25\" />\n",
       "  <line x1=\"23\" y1=\"0\" x2=\"23\" y2=\"25\" />\n",
       "  <line x1=\"24\" y1=\"0\" x2=\"24\" y2=\"25\" />\n",
       "  <line x1=\"24\" y1=\"0\" x2=\"24\" y2=\"25\" />\n",
       "  <line x1=\"25\" y1=\"0\" x2=\"25\" y2=\"25\" />\n",
       "  <line x1=\"25\" y1=\"0\" x2=\"25\" y2=\"25\" />\n",
       "  <line x1=\"26\" y1=\"0\" x2=\"26\" y2=\"25\" />\n",
       "  <line x1=\"27\" y1=\"0\" x2=\"27\" y2=\"25\" />\n",
       "  <line x1=\"27\" y1=\"0\" x2=\"27\" y2=\"25\" />\n",
       "  <line x1=\"28\" y1=\"0\" x2=\"28\" y2=\"25\" />\n",
       "  <line x1=\"28\" y1=\"0\" x2=\"28\" y2=\"25\" />\n",
       "  <line x1=\"29\" y1=\"0\" x2=\"29\" y2=\"25\" />\n",
       "  <line x1=\"30\" y1=\"0\" x2=\"30\" y2=\"25\" />\n",
       "  <line x1=\"30\" y1=\"0\" x2=\"30\" y2=\"25\" />\n",
       "  <line x1=\"31\" y1=\"0\" x2=\"31\" y2=\"25\" />\n",
       "  <line x1=\"31\" y1=\"0\" x2=\"31\" y2=\"25\" />\n",
       "  <line x1=\"32\" y1=\"0\" x2=\"32\" y2=\"25\" />\n",
       "  <line x1=\"33\" y1=\"0\" x2=\"33\" y2=\"25\" />\n",
       "  <line x1=\"33\" y1=\"0\" x2=\"33\" y2=\"25\" />\n",
       "  <line x1=\"34\" y1=\"0\" x2=\"34\" y2=\"25\" />\n",
       "  <line x1=\"34\" y1=\"0\" x2=\"34\" y2=\"25\" />\n",
       "  <line x1=\"35\" y1=\"0\" x2=\"35\" y2=\"25\" />\n",
       "  <line x1=\"36\" y1=\"0\" x2=\"36\" y2=\"25\" />\n",
       "  <line x1=\"36\" y1=\"0\" x2=\"36\" y2=\"25\" />\n",
       "  <line x1=\"37\" y1=\"0\" x2=\"37\" y2=\"25\" />\n",
       "  <line x1=\"37\" y1=\"0\" x2=\"37\" y2=\"25\" />\n",
       "  <line x1=\"38\" y1=\"0\" x2=\"38\" y2=\"25\" />\n",
       "  <line x1=\"39\" y1=\"0\" x2=\"39\" y2=\"25\" />\n",
       "  <line x1=\"39\" y1=\"0\" x2=\"39\" y2=\"25\" />\n",
       "  <line x1=\"40\" y1=\"0\" x2=\"40\" y2=\"25\" />\n",
       "  <line x1=\"40\" y1=\"0\" x2=\"40\" y2=\"25\" />\n",
       "  <line x1=\"41\" y1=\"0\" x2=\"41\" y2=\"25\" />\n",
       "  <line x1=\"42\" y1=\"0\" x2=\"42\" y2=\"25\" />\n",
       "  <line x1=\"42\" y1=\"0\" x2=\"42\" y2=\"25\" />\n",
       "  <line x1=\"43\" y1=\"0\" x2=\"43\" y2=\"25\" />\n",
       "  <line x1=\"43\" y1=\"0\" x2=\"43\" y2=\"25\" />\n",
       "  <line x1=\"44\" y1=\"0\" x2=\"44\" y2=\"25\" />\n",
       "  <line x1=\"45\" y1=\"0\" x2=\"45\" y2=\"25\" />\n",
       "  <line x1=\"45\" y1=\"0\" x2=\"45\" y2=\"25\" />\n",
       "  <line x1=\"46\" y1=\"0\" x2=\"46\" y2=\"25\" />\n",
       "  <line x1=\"46\" y1=\"0\" x2=\"46\" y2=\"25\" />\n",
       "  <line x1=\"47\" y1=\"0\" x2=\"47\" y2=\"25\" />\n",
       "  <line x1=\"48\" y1=\"0\" x2=\"48\" y2=\"25\" />\n",
       "  <line x1=\"48\" y1=\"0\" x2=\"48\" y2=\"25\" />\n",
       "  <line x1=\"49\" y1=\"0\" x2=\"49\" y2=\"25\" />\n",
       "  <line x1=\"49\" y1=\"0\" x2=\"49\" y2=\"25\" />\n",
       "  <line x1=\"50\" y1=\"0\" x2=\"50\" y2=\"25\" />\n",
       "  <line x1=\"51\" y1=\"0\" x2=\"51\" y2=\"25\" />\n",
       "  <line x1=\"51\" y1=\"0\" x2=\"51\" y2=\"25\" />\n",
       "  <line x1=\"52\" y1=\"0\" x2=\"52\" y2=\"25\" />\n",
       "  <line x1=\"52\" y1=\"0\" x2=\"52\" y2=\"25\" />\n",
       "  <line x1=\"53\" y1=\"0\" x2=\"53\" y2=\"25\" />\n",
       "  <line x1=\"54\" y1=\"0\" x2=\"54\" y2=\"25\" />\n",
       "  <line x1=\"54\" y1=\"0\" x2=\"54\" y2=\"25\" />\n",
       "  <line x1=\"55\" y1=\"0\" x2=\"55\" y2=\"25\" />\n",
       "  <line x1=\"55\" y1=\"0\" x2=\"55\" y2=\"25\" />\n",
       "  <line x1=\"56\" y1=\"0\" x2=\"56\" y2=\"25\" />\n",
       "  <line x1=\"57\" y1=\"0\" x2=\"57\" y2=\"25\" />\n",
       "  <line x1=\"57\" y1=\"0\" x2=\"57\" y2=\"25\" />\n",
       "  <line x1=\"58\" y1=\"0\" x2=\"58\" y2=\"25\" />\n",
       "  <line x1=\"58\" y1=\"0\" x2=\"58\" y2=\"25\" />\n",
       "  <line x1=\"59\" y1=\"0\" x2=\"59\" y2=\"25\" />\n",
       "  <line x1=\"60\" y1=\"0\" x2=\"60\" y2=\"25\" />\n",
       "  <line x1=\"60\" y1=\"0\" x2=\"60\" y2=\"25\" />\n",
       "  <line x1=\"61\" y1=\"0\" x2=\"61\" y2=\"25\" />\n",
       "  <line x1=\"61\" y1=\"0\" x2=\"61\" y2=\"25\" />\n",
       "  <line x1=\"62\" y1=\"0\" x2=\"62\" y2=\"25\" />\n",
       "  <line x1=\"63\" y1=\"0\" x2=\"63\" y2=\"25\" />\n",
       "  <line x1=\"63\" y1=\"0\" x2=\"63\" y2=\"25\" />\n",
       "  <line x1=\"64\" y1=\"0\" x2=\"64\" y2=\"25\" />\n",
       "  <line x1=\"64\" y1=\"0\" x2=\"64\" y2=\"25\" />\n",
       "  <line x1=\"65\" y1=\"0\" x2=\"65\" y2=\"25\" />\n",
       "  <line x1=\"66\" y1=\"0\" x2=\"66\" y2=\"25\" />\n",
       "  <line x1=\"66\" y1=\"0\" x2=\"66\" y2=\"25\" />\n",
       "  <line x1=\"67\" y1=\"0\" x2=\"67\" y2=\"25\" />\n",
       "  <line x1=\"67\" y1=\"0\" x2=\"67\" y2=\"25\" />\n",
       "  <line x1=\"68\" y1=\"0\" x2=\"68\" y2=\"25\" />\n",
       "  <line x1=\"69\" y1=\"0\" x2=\"69\" y2=\"25\" />\n",
       "  <line x1=\"69\" y1=\"0\" x2=\"69\" y2=\"25\" />\n",
       "  <line x1=\"70\" y1=\"0\" x2=\"70\" y2=\"25\" />\n",
       "  <line x1=\"70\" y1=\"0\" x2=\"70\" y2=\"25\" />\n",
       "  <line x1=\"71\" y1=\"0\" x2=\"71\" y2=\"25\" />\n",
       "  <line x1=\"72\" y1=\"0\" x2=\"72\" y2=\"25\" />\n",
       "  <line x1=\"72\" y1=\"0\" x2=\"72\" y2=\"25\" />\n",
       "  <line x1=\"73\" y1=\"0\" x2=\"73\" y2=\"25\" />\n",
       "  <line x1=\"73\" y1=\"0\" x2=\"73\" y2=\"25\" />\n",
       "  <line x1=\"74\" y1=\"0\" x2=\"74\" y2=\"25\" />\n",
       "  <line x1=\"75\" y1=\"0\" x2=\"75\" y2=\"25\" />\n",
       "  <line x1=\"75\" y1=\"0\" x2=\"75\" y2=\"25\" />\n",
       "  <line x1=\"76\" y1=\"0\" x2=\"76\" y2=\"25\" />\n",
       "  <line x1=\"76\" y1=\"0\" x2=\"76\" y2=\"25\" />\n",
       "  <line x1=\"77\" y1=\"0\" x2=\"77\" y2=\"25\" />\n",
       "  <line x1=\"78\" y1=\"0\" x2=\"78\" y2=\"25\" />\n",
       "  <line x1=\"78\" y1=\"0\" x2=\"78\" y2=\"25\" />\n",
       "  <line x1=\"79\" y1=\"0\" x2=\"79\" y2=\"25\" />\n",
       "  <line x1=\"79\" y1=\"0\" x2=\"79\" y2=\"25\" />\n",
       "  <line x1=\"80\" y1=\"0\" x2=\"80\" y2=\"25\" />\n",
       "  <line x1=\"81\" y1=\"0\" x2=\"81\" y2=\"25\" />\n",
       "  <line x1=\"81\" y1=\"0\" x2=\"81\" y2=\"25\" />\n",
       "  <line x1=\"82\" y1=\"0\" x2=\"82\" y2=\"25\" />\n",
       "  <line x1=\"82\" y1=\"0\" x2=\"82\" y2=\"25\" />\n",
       "  <line x1=\"83\" y1=\"0\" x2=\"83\" y2=\"25\" />\n",
       "  <line x1=\"84\" y1=\"0\" x2=\"84\" y2=\"25\" />\n",
       "  <line x1=\"84\" y1=\"0\" x2=\"84\" y2=\"25\" />\n",
       "  <line x1=\"85\" y1=\"0\" x2=\"85\" y2=\"25\" />\n",
       "  <line x1=\"85\" y1=\"0\" x2=\"85\" y2=\"25\" />\n",
       "  <line x1=\"86\" y1=\"0\" x2=\"86\" y2=\"25\" />\n",
       "  <line x1=\"87\" y1=\"0\" x2=\"87\" y2=\"25\" />\n",
       "  <line x1=\"87\" y1=\"0\" x2=\"87\" y2=\"25\" />\n",
       "  <line x1=\"88\" y1=\"0\" x2=\"88\" y2=\"25\" />\n",
       "  <line x1=\"88\" y1=\"0\" x2=\"88\" y2=\"25\" />\n",
       "  <line x1=\"89\" y1=\"0\" x2=\"89\" y2=\"25\" />\n",
       "  <line x1=\"90\" y1=\"0\" x2=\"90\" y2=\"25\" />\n",
       "  <line x1=\"90\" y1=\"0\" x2=\"90\" y2=\"25\" />\n",
       "  <line x1=\"91\" y1=\"0\" x2=\"91\" y2=\"25\" />\n",
       "  <line x1=\"91\" y1=\"0\" x2=\"91\" y2=\"25\" />\n",
       "  <line x1=\"92\" y1=\"0\" x2=\"92\" y2=\"25\" />\n",
       "  <line x1=\"93\" y1=\"0\" x2=\"93\" y2=\"25\" />\n",
       "  <line x1=\"93\" y1=\"0\" x2=\"93\" y2=\"25\" />\n",
       "  <line x1=\"94\" y1=\"0\" x2=\"94\" y2=\"25\" />\n",
       "  <line x1=\"94\" y1=\"0\" x2=\"94\" y2=\"25\" />\n",
       "  <line x1=\"95\" y1=\"0\" x2=\"95\" y2=\"25\" />\n",
       "  <line x1=\"96\" y1=\"0\" x2=\"96\" y2=\"25\" />\n",
       "  <line x1=\"96\" y1=\"0\" x2=\"96\" y2=\"25\" />\n",
       "  <line x1=\"97\" y1=\"0\" x2=\"97\" y2=\"25\" />\n",
       "  <line x1=\"97\" y1=\"0\" x2=\"97\" y2=\"25\" />\n",
       "  <line x1=\"98\" y1=\"0\" x2=\"98\" y2=\"25\" />\n",
       "  <line x1=\"99\" y1=\"0\" x2=\"99\" y2=\"25\" />\n",
       "  <line x1=\"99\" y1=\"0\" x2=\"99\" y2=\"25\" />\n",
       "  <line x1=\"100\" y1=\"0\" x2=\"100\" y2=\"25\" />\n",
       "  <line x1=\"100\" y1=\"0\" x2=\"100\" y2=\"25\" />\n",
       "  <line x1=\"101\" y1=\"0\" x2=\"101\" y2=\"25\" />\n",
       "  <line x1=\"102\" y1=\"0\" x2=\"102\" y2=\"25\" />\n",
       "  <line x1=\"102\" y1=\"0\" x2=\"102\" y2=\"25\" />\n",
       "  <line x1=\"103\" y1=\"0\" x2=\"103\" y2=\"25\" />\n",
       "  <line x1=\"103\" y1=\"0\" x2=\"103\" y2=\"25\" />\n",
       "  <line x1=\"104\" y1=\"0\" x2=\"104\" y2=\"25\" />\n",
       "  <line x1=\"105\" y1=\"0\" x2=\"105\" y2=\"25\" />\n",
       "  <line x1=\"105\" y1=\"0\" x2=\"105\" y2=\"25\" />\n",
       "  <line x1=\"106\" y1=\"0\" x2=\"106\" y2=\"25\" />\n",
       "  <line x1=\"106\" y1=\"0\" x2=\"106\" y2=\"25\" />\n",
       "  <line x1=\"107\" y1=\"0\" x2=\"107\" y2=\"25\" />\n",
       "  <line x1=\"108\" y1=\"0\" x2=\"108\" y2=\"25\" />\n",
       "  <line x1=\"108\" y1=\"0\" x2=\"108\" y2=\"25\" />\n",
       "  <line x1=\"109\" y1=\"0\" x2=\"109\" y2=\"25\" />\n",
       "  <line x1=\"109\" y1=\"0\" x2=\"109\" y2=\"25\" />\n",
       "  <line x1=\"110\" y1=\"0\" x2=\"110\" y2=\"25\" />\n",
       "  <line x1=\"111\" y1=\"0\" x2=\"111\" y2=\"25\" />\n",
       "  <line x1=\"111\" y1=\"0\" x2=\"111\" y2=\"25\" />\n",
       "  <line x1=\"112\" y1=\"0\" x2=\"112\" y2=\"25\" />\n",
       "  <line x1=\"112\" y1=\"0\" x2=\"112\" y2=\"25\" />\n",
       "  <line x1=\"113\" y1=\"0\" x2=\"113\" y2=\"25\" />\n",
       "  <line x1=\"114\" y1=\"0\" x2=\"114\" y2=\"25\" />\n",
       "  <line x1=\"114\" y1=\"0\" x2=\"114\" y2=\"25\" />\n",
       "  <line x1=\"115\" y1=\"0\" x2=\"115\" y2=\"25\" />\n",
       "  <line x1=\"115\" y1=\"0\" x2=\"115\" y2=\"25\" />\n",
       "  <line x1=\"116\" y1=\"0\" x2=\"116\" y2=\"25\" />\n",
       "  <line x1=\"117\" y1=\"0\" x2=\"117\" y2=\"25\" />\n",
       "  <line x1=\"117\" y1=\"0\" x2=\"117\" y2=\"25\" />\n",
       "  <line x1=\"118\" y1=\"0\" x2=\"118\" y2=\"25\" />\n",
       "  <line x1=\"118\" y1=\"0\" x2=\"118\" y2=\"25\" />\n",
       "  <line x1=\"119\" y1=\"0\" x2=\"119\" y2=\"25\" />\n",
       "  <line x1=\"120\" y1=\"0\" x2=\"120\" y2=\"25\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"0.000000,0.000000 120.000000,0.000000 120.000000,25.412617 0.000000,25.412617\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"60.000000\" y=\"45.412617\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >200000</text>\n",
       "  <text x=\"140.000000\" y=\"12.706308\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,140.000000,12.706308)\">1</text>\n",
       "</svg>\n",
       "</td>\n",
       "</tr>\n",
       "</table>"
      ],
      "text/plain": [
       "dask.array<mean_agg-aggregate, shape=(200000,), dtype=float64, chunksize=(1000,), chunktype=numpy.ndarray>"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "big_ones_reduce = (np.cos(big_ones)**2).mean(axis=1)\n",
    "big_ones_reduce"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Plotting also triggers computation, since we need the actual values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "from matplotlib import pyplot as plt\n",
    "%matplotlib inline\n",
    "plt.rcParams['figure.figsize'] = (12,8)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7fbd05d4c5d0>]"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 864x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(big_ones_reduce)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Dask Delayed\n",
    "\n",
    "Dask.delayed is a simple and powerful way to parallelize existing code.  It allows users to delay function calls into a task graph with dependencies.  Dask.delayed doesn't provide any fancy parallel algorithms like Dask.dataframe, but it does give the user complete control over what they want to build.\n",
    "\n",
    "Systems like Dask.dataframe are built with Dask.delayed.  If you have a problem that is paralellizable, but isn't as simple as just a big array or a big dataframe, then dask.delayed may be the right choice for you.\n",
    "\n",
    "## Create simple functions\n",
    "\n",
    "These functions do simple operations like add two numbers together, but they sleep for a random amount of time to simulate real work."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "import time\n",
    "\n",
    "def inc(x):\n",
    "    time.sleep(0.1)\n",
    "    return x + 1\n",
    "\n",
    "def dec(x):\n",
    "    time.sleep(0.1)\n",
    "    return x - 1\n",
    "    \n",
    "def add(x, y):\n",
    "    time.sleep(0.2)\n",
    "    return x + y "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We can run them like normal Python functions below"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 20.4 ms, sys: 3.98 ms, total: 24.4 ms\n",
      "Wall time: 401 ms\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "3"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%time\n",
    "x = inc(1)\n",
    "y = dec(2)\n",
    "z = add(x, y)\n",
    "z"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "These ran one after the other, in sequence.  Note though that the first two lines `inc(1)` and `dec(2)` don't depend on each other, we *could* have called them in parallel had we been clever.\n",
    "\n",
    "## Annotate functions with Dask Delayed to make them lazy\n",
    "\n",
    "We can call `dask.delayed` on our funtions to make them lazy.  Rather than compute their results immediately, they record what we want to compute as a task into a graph that we'll run later on parallel hardware."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "import dask\n",
    "inc = dask.delayed(inc)\n",
    "dec = dask.delayed(dec)\n",
    "add = dask.delayed(add)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Calling these lazy functions is now almost free.  We're just constructing a graph"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 1.49 ms, sys: 125 s, total: 1.61 ms\n",
      "Wall time: 1.37 ms\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "Delayed('add-6d23683e-7734-4a48-95d8-d6c5c3c6cb3b')"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%time\n",
    "x = inc(1)\n",
    "y = dec(2)\n",
    "z = add(x, y)\n",
    "z"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Visualize computation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<svg height=\"130pt\" viewBox=\"0.00 0.00 334.49 130.00\" width=\"334pt\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g class=\"graph\" id=\"graph0\" transform=\"scale(1 1) rotate(0) translate(4 126)\">\n",
       "<title>%3</title>\n",
       "<polygon fill=\"white\" points=\"-4,4 -4,-126 330.49,-126 330.49,4 -4,4\" stroke=\"transparent\"/>\n",
       "<!-- 3584993900038910633 -->\n",
       "<g class=\"node\" id=\"node1\">\n",
       "<title>3584993900038910633</title>\n",
       "<ellipse cx=\"208.54\" cy=\"-59.7\" fill=\"none\" rx=\"27.9\" ry=\"27.9\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"208.54\" y=\"-56\">add</text>\n",
       "</g>\n",
       "<!-- &#45;665463632500943370 -->\n",
       "<g class=\"node\" id=\"node2\">\n",
       "<title>-665463632500943370</title>\n",
       "<polygon fill=\"none\" points=\"326.49,-77.7 272.49,-77.7 272.49,-41.7 326.49,-41.7 326.49,-77.7\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 3584993900038910633&#45;&gt;&#45;665463632500943370 -->\n",
       "<g class=\"edge\" id=\"edge1\">\n",
       "<title>3584993900038910633-&gt;-665463632500943370</title>\n",
       "<path d=\"M236.71,-59.7C244.78,-59.7 253.74,-59.7 262.28,-59.7\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"262.4,-63.2 272.4,-59.7 262.4,-56.2 262.4,-63.2\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;664965776601873180 -->\n",
       "<g class=\"node\" id=\"node3\">\n",
       "<title>-664965776601873180</title>\n",
       "<polygon fill=\"none\" points=\"144.6,-108.7 90.6,-108.7 90.6,-72.7 144.6,-72.7 144.6,-108.7\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- &#45;664965776601873180&#45;&gt;3584993900038910633 -->\n",
       "<g class=\"edge\" id=\"edge2\">\n",
       "<title>-664965776601873180-&gt;3584993900038910633</title>\n",
       "<path d=\"M144.8,-81.56C153.38,-78.57 163.06,-75.2 172.2,-72.02\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"173.54,-75.26 181.83,-68.66 171.24,-68.65 173.54,-75.26\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 739386654143298693 -->\n",
       "<g class=\"node\" id=\"node4\">\n",
       "<title>739386654143298693</title>\n",
       "<polygon fill=\"none\" points=\"144.6,-50.7 90.6,-50.7 90.6,-14.7 144.6,-14.7 144.6,-50.7\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 739386654143298693&#45;&gt;3584993900038910633 -->\n",
       "<g class=\"edge\" id=\"edge3\">\n",
       "<title>739386654143298693-&gt;3584993900038910633</title>\n",
       "<path d=\"M144.8,-40.65C153.22,-43.21 162.69,-46.08 171.67,-48.81\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"170.94,-52.24 181.52,-51.8 172.97,-45.55 170.94,-52.24\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 2268567533632111498 -->\n",
       "<g class=\"node\" id=\"node5\">\n",
       "<title>2268567533632111498</title>\n",
       "<ellipse cx=\"27.3\" cy=\"-24.7\" fill=\"none\" rx=\"24.9\" ry=\"24.9\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"27.3\" y=\"-21\">inc</text>\n",
       "</g>\n",
       "<!-- 2268567533632111498&#45;&gt;739386654143298693 -->\n",
       "<g class=\"edge\" id=\"edge4\">\n",
       "<title>2268567533632111498-&gt;739386654143298693</title>\n",
       "<path d=\"M51.96,-26.84C60.66,-27.63 70.73,-28.54 80.29,-29.41\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"80.1,-32.91 90.38,-30.32 80.74,-25.93 80.1,-32.91\" stroke=\"black\"/>\n",
       "</g>\n",
       "<!-- 4415260863078038291 -->\n",
       "<g class=\"node\" id=\"node6\">\n",
       "<title>4415260863078038291</title>\n",
       "<ellipse cx=\"27.3\" cy=\"-94.7\" fill=\"none\" rx=\"27.1\" ry=\"27.1\" stroke=\"black\"/>\n",
       "<text font-family=\"Times,serif\" font-size=\"14.00\" text-anchor=\"middle\" x=\"27.3\" y=\"-91\">dec</text>\n",
       "</g>\n",
       "<!-- 4415260863078038291&#45;&gt;&#45;664965776601873180 -->\n",
       "<g class=\"edge\" id=\"edge5\">\n",
       "<title>4415260863078038291-&gt;-664965776601873180</title>\n",
       "<path d=\"M54.79,-93.5C62.81,-93.13 71.75,-92.73 80.3,-92.34\" fill=\"none\" stroke=\"black\"/>\n",
       "<polygon fill=\"black\" points=\"80.59,-95.83 90.43,-91.88 80.28,-88.84 80.59,-95.83\" stroke=\"black\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>"
      ],
      "text/plain": [
       "<IPython.core.display.SVG object>"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "z.visualize(format='svg', rankdir='LR')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Run in parallel\n",
    "\n",
    "Call `.compute()` when you want your result as a normal Python object\n",
    "\n",
    "If you started `Client()` above then you may want to watch the status page during computation."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 40.2 ms, sys: 424 s, total: 40.7 ms\n",
      "Wall time: 334 ms\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "3"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%time\n",
    "z.compute()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Parallelize Normal Python code\n",
    "\n",
    "Now we use Dask in normal for-loopy Python code.  This generates graphs instead of doing computations directly, but still looks like the code we had before.  Dask is a convenient way to add parallelism to existing workflows."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 224 ms, sys: 60.5 ms, total: 285 ms\n",
      "Wall time: 274 ms\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "zs = []\n",
    "for i in range(256):\n",
    "    x = inc(i)\n",
    "    y = dec(x)\n",
    "    z = add(x, y)\n",
    "    zs.append(z)\n",
    "    \n",
    "zs = dask.persist(*zs)  # trigger computation in the background"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
